<HTML>

<HEAD>

<TITLE>fp_dong2.htm : Dongle Bashing ~ End of the dongle old aera ~ second part</TITLE>

</HEAD>

<BODY BGCOLOR=#C0C0C0 TEXT=#001010 VLINK=#405040>

<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" HEIGHT="22"  WIDTH= "100%">

<TR><TD></TD>

<TD>

<CENTER><FONT SIZE="+2">Dongle Bashing</FONT><BR>

        <FONT SIZE="+1">End of the dongle old aera ~ Dongles bye bye</FONT><BR>(re-uploade version October 1998)<BR>

or<BR>

"How a single +HCU reverser can easily blow a whole commercial sector out 

of history"



</CENTER>

</TD>

<TD>

<CENTER><A href="advanced.htm" tppabs="http://www.anticrack.de/fravia/advanced.htm"><IMG SRC="xtranio.gif" tppabs="http://www.anticrack.de/fravia/xtranio.gif" ALT="advanced" 

ALIGN=CENTER WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 

HSPACE=0></A>

<BR>

<FONT color=gray>Advanced</FONT>

</CENTER></TD></TR>

<TR>

<TD bgcolor="#FFFFEA"><CENTER>

<FONT COLOR="890000">

29 January 1998

</FONT></CENTER>

</TD>

<TD bgcolor="#FFFFEA"><CENTER>

by 

<FONT size=+3>

Frog's print

</FONT></CENTER>

</TD>

<TD VALIGN="center" bgcolor="#FFFFEA">

<A href="hcu98_3.htm" tppabs="http://www.anticrack.de/fravia/hcu98_3.htm"><IMG SRC="hcu1.gif" tppabs="http://www.anticrack.de/fravia/hcu1.gif" ALT="+cracker" ALIGN=BOTTOM 

WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></A></TD>

</TR>

<TR><TD><CENTER><A href="index.html" tppabs="http://www.anticrack.de/fravia/index.html">

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALIGN="BOTTOM" 

BORDER="0"

VSPACE="0" HSPACE="0" width="13" height="13"></A></CENTER></TD>

<TD BGCOLOR="898030"><CENTER>Courtesy of Fravia's page of 

reverse engineering</CENTER> 

</CENTER></TD></TR></TABLE>

<CENTER>

<H1>SECOND PART</H1><BR>

(<A href="fp_dong1.htm" tppabs="http://www.anticrack.de/fravia/fp_dong1.htm">Back to first part</A>)</CENTER>

<HR WIDTH="100%">

<BR><B><U><FONT SIZE=+2>Label Craft v6.01</FONT></U></B>

<BR><B>-Description:</B>

<BR>Program for creating and editing all types of labels in the Microsoft

Windows environment..

<BR><B>-OS:</B>

<BR>Win3.xx/95 (16bit)

<BR><B>-Protection:</B>

<BR>Dongle (parallel key). Driver: none

<BR><B>-Misc.:</B>

<BR>Run as a&nbsp; DEMO if no dongle detected (Save and Save As are disabled,any

printed document will have: letters in text strings mixed up, numbers randomized,

graphics overcrossed).



<P><TT>This program doesn't require any external known driver. The dongle

protection is located in the main executable: <I>plabel.exe</I> (379Kb).</TT>

<BR><TT>Since this soft uses its own routines to check if there is a dongle,

let's have a quick look at its HLP file:</TT>

<BR><I><TT><FONT COLOR="#000000">'This software is protected with a hardware

key which must be plugged into the parallel printer port at the back of

your PC. Without the key LabelCraft runs in demo mode. The following message

is then shown when you choose Label Printing or Label Editing from the

main menu: 'Missing key lock! Continue as Demoversion?'.</FONT></TT></I>

<BR><TT>I have to say that this is not really helpful!</TT>

<BR><TT>Never mind, let's Zen crack:</TT>



<P><TT>With SoftICE:</TT>

<BR><TT>&nbsp;&nbsp;&nbsp; BPIO -H 378</TT>



<P><TT>Run the program and a dialog box pops asking you to choose between

"Editing" or "Printing a label"</TT>

<BR><TT>Press "Editing" and SoftICE will break here:</TT>



<P><TT>.0001BFEA: EE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

out&nbsp;&nbsp;&nbsp; dx,al&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">;&nbsp;

Here</FONT></TT>

<BR><TT>.0001BFEB: EB00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

jmps&nbsp; .00001BFED&nbsp;</TT>

<BR><TT>.0001BFED: 8B0ECA3B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;

cx,[03BCA]</TT>

<BR><TT>.0001BFF1: E2FE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

loop&nbsp; .00001BFF1&nbsp;</TT>

<BR><TT>.0001BFF3: A17C09&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

mov&nbsp;&nbsp;&nbsp; ax,[0097C]</TT>

<BR><TT>.0001BFF6: 050200&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

add&nbsp;&nbsp;&nbsp; ax,00002</TT>

<BR><TT>This is the main routine that will checks your // port for the

dongle.</TT>

<BR><TT>To find the caller, it is very important to disable any BPIO before

pressing the &lt;F12> key otherwise SoftICE will break several times.</TT>

<BR><TT>With SoftICE:</TT>

<BR><TT>&nbsp;&nbsp;&nbsp; BD *</TT>

<BR><TT>&nbsp;&nbsp;&nbsp; &lt;F12> (press it 3 times)</TT>



<P><TT>We land here:</TT>

<BR><TT>.00015575: 9ADA543B55&nbsp;&nbsp;&nbsp;&nbsp; call&nbsp;&nbsp;

001:054DA <FONT COLOR="#3333FF">; Check // port</FONT>&nbsp;</TT>

<BR><TT>.0001557A: 83C404&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

add&nbsp;&nbsp;&nbsp; sp,004</TT>

<BR><TT>.0001557D: 3D457F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

cmp&nbsp;&nbsp;&nbsp; ax,07F45&nbsp; <FONT COLOR="#3333FF">; Is there a

dongle?</FONT></TT>

<BR><TT>.00015580: 7408&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

je&nbsp;&nbsp;&nbsp; .00001558A <FONT COLOR="#3333FF">; Yes, jump...</FONT></TT>

<BR><TT>.00015582: 46&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

inc&nbsp;&nbsp;&nbsp; si<FONT COLOR="#3333FF">&nbsp;</FONT></TT>

<BR><TT>.00015583: 83FE03&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

cmp&nbsp;&nbsp;&nbsp; si,003</TT>

<BR><TT>.00015586: 7EC6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

jle&nbsp;&nbsp; .00001554E</TT>

<BR><TT>.00015588: EB06&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

jmps&nbsp; .000015590 <FONT COLOR="#3333FF">; Bad_Guy_Jump</FONT></TT>

<BR><TT>.0001558A: B80100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

mov&nbsp;&nbsp;&nbsp; ax,00001&nbsp; <FONT COLOR="#3333FF">; Good_Guy</FONT></TT>

<BR><TT>.0001558D: 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

pop&nbsp;&nbsp;&nbsp; si</TT>

<BR><TT>.0001558E: C9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

leave</TT>

<BR><TT>.0001558F: C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

retn</TT>



<P><TT>When I reached the <I>cmp ax,7F45</I> instruction, I saw in the

registers windows that ax=FFFF. I quickly patched the <I>je 1558A</I> with

<I>jumps 1558A</I>.</TT>

<BR><TT>The program seems to work well and we don't get any warning message

about the missing dongle. As the "Save" feature is disabled, I check the

main menu and...there are no "Save', "Save as" submenus!</TT>

<BR><TT>There is a screw loose somewhere.</TT>

<BR><TT>In fact, I just did a little mistake here: I said above to disable

the BPIO before pressing the &lt;F12> key and realized that I didn't re-enable

it again right after. When running a Dongle protected soft, it is necessary

to always have a BPIO enable, because the program may check at any time

the presence of the dongle.</TT>

<BR><TT>Exit Label Craft. Enable the BPIO until you reach the above code.

Disable it, press &lt;F12> 3 times and patch the <I>je 1558A</I> again.</TT>

<BR><TT>Now re-enable the BPIO and let the program run. SoftICE will pops

at offset .0001BFEA again.</TT>

<BR><TT>With SoftICE:</TT>

<BR><TT>&nbsp;&nbsp;&nbsp; BD *</TT>

<BR><TT>&nbsp;&nbsp;&nbsp; &lt;F12> (press it 3 times)</TT>



<P><TT>And we'll finally land here:&nbsp;</TT>

<BR><TT>.000147F7: 9ADA540748&nbsp;&nbsp;&nbsp;&nbsp; call&nbsp;&nbsp;

001:054DA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">; Check

// port</FONT>&nbsp;</TT>

<BR><TT>.000147FC: 83C404&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

add&nbsp;&nbsp;&nbsp; sp,004&nbsp;</TT>

<BR><TT>.000147FF: 3D9E6F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

cmp&nbsp;&nbsp;&nbsp; ax,06F9E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Is there a dongle?</FONT>&nbsp;</TT>

<BR><TT>.00014802: 740B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

je&nbsp;&nbsp;&nbsp; .00001480F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">;

Yes, jump...</FONT>&nbsp;</TT>

<BR><TT>.00014804: 9A58531248&nbsp;&nbsp;&nbsp;&nbsp; call&nbsp;&nbsp;

001:05358&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">; otherwise

disable "Save/Save as".</FONT></TT>

<BR><TT>.00014809: C706FC4E0100&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp; w,[04EFC],00001

<FONT COLOR="#3333FF">; Set Bad_Guy_Flag.</FONT></TT>

<BR><TT>.0001480F: 9A9E53AC46&nbsp;&nbsp;&nbsp;&nbsp; call&nbsp;&nbsp;

001:0539E&nbsp;</TT>

<BR><TT>.00014814: B80100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

mov&nbsp;&nbsp;&nbsp; ax,00001&nbsp;</TT>

<BR><TT>.00014817: 8D66FE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

lea&nbsp;&nbsp;&nbsp; sp,[bp][-0002]&nbsp;</TT>

<BR><TT>.0001481A: 1F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

pop&nbsp;&nbsp;&nbsp; ds&nbsp;</TT>

<BR><TT>.0001481B: 5D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

pop&nbsp;&nbsp;&nbsp; bp&nbsp;</TT>

<BR><TT>.0001481C: 4D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

dec&nbsp;&nbsp;&nbsp; bp&nbsp;</TT>

<BR><TT>.0001481D: CB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

retf&nbsp;</TT>

<BR><TT>Just make it always jump at offset .00014802.</TT>



<P><TT>Now, it may be a good idea to disasm the file to see if there is

any other similar check (another -slow- solution would be to enable the

BPIO and, with SoftICE, to test ALL features of the program -copy, printing...-

but I don't have that much time to waste -:). W32Dasm v6.xx should be fine

(plabel.exe is a 16bit file).</TT>



<P><TT>And here is what we find:</TT>



<P><TT>.00050461: 9ADA547704&nbsp;&nbsp;&nbsp;&nbsp; call&nbsp;&nbsp; 001:054DA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Check // port</FONT></TT>

<BR><TT>.00050466: 83C404&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

add&nbsp;&nbsp;&nbsp; sp,004</TT>

<BR><TT>.00050469: 3D64D4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

cmp&nbsp;&nbsp;&nbsp; ax,0D464&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Is there a dongle?</FONT>&nbsp;</TT>

<BR><TT>.0005046C: 740B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

je&nbsp;&nbsp;&nbsp; .000050479&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">;

Yes, jump otherwise...&nbsp;</FONT></TT>

<BR><TT>.0005046E: C706FC4E0100&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp; w,[04EFC],00001

<FONT COLOR="#3333FF">; set Bad_Guy_Flag and</FONT></TT>

<BR><TT>.00050474: 9A58538C04&nbsp;&nbsp;&nbsp;&nbsp; call&nbsp;&nbsp;

001:05358&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">; add

garbages to the printing function...</FONT></TT>

<BR><TT>.00050479: 833EFC4E00&nbsp;&nbsp;&nbsp;&nbsp; cmp&nbsp;&nbsp;&nbsp;

w,[04EFC],000&nbsp;</TT>

<BR><TT>.0005047E: 7503&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

jne&nbsp;&nbsp; .000050483&nbsp;&nbsp;&nbsp;&nbsp;</TT>

<BR><TT>.00050480: E90E01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

jmp&nbsp;&nbsp; .000050591&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">;

Go ahead if Dongle_OK.</FONT>&nbsp;</TT>

<BR><TT>.00050483: 9AFFFF0000&nbsp;&nbsp;&nbsp;&nbsp; call&nbsp;&nbsp;

GETTICKCOUNT</TT>

<BR><TT>.00050488: 50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push&nbsp;&nbsp; ax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TT>

<BR><TT>.00050489: 9A1E852001&nbsp;&nbsp;&nbsp;&nbsp; call&nbsp;&nbsp;

001:0851E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TT>

<BR><TT>Patching the <I>je .000050479</I> will fully crack this soft.</TT>



<P><TT>As we can see, there's nothing really amazing in this protection

but it is a bit more 'personal' and more discreet than the usual routines

used by important dongle manufacturer. It would be more complicated to

crack if some strong anti-softICE/disasm tricks would be added.</TT>



<P>&nbsp;

<HR WIDTH="100%">

<BR><A NAME="Ai Damage"></A><B><U><FONT SIZE=+2>Ai Damage v1.4</FONT></U></B>

<BR><B>-Description:</B>

<BR>Program to find the change in velocity of a vehicle from an analysis

of the damage caused

<BR><B>-OS:</B>

<BR>Win95/ <FONT COLOR="#000000">NT&nbsp;&nbsp;</FONT>

<BR><B>-Protection:</B>

<BR>Dongle (parallel key). Driver: DK2 DESkey

<BR><B>-Misc.:</B>

<BR>Does NOT run if no dongle detected . Dongle license valid for 1 year.



<P><TT>If you didn't understand the program description here is another

one:</TT>

<BR><I><TT>"AiTS was founded to teach accident investigation, and to provide

software to assist accident investigators in their task.</TT></I>

<BR><TT><I>Ai Damage calculates changes in speed from the damage caused

to vehicles. The program not only uses the tried and tested Crash3 algorthims,

but also uses the principle of the conservation of linear momentum (in

two dimensions) to fully analyse your accident"</I>.</TT>

<BR><TT>To resume, this is just another crap I will erase from my HD right

after this essay.</TT>



<P><TT>This program requires the DK2 DESkey dongle driver (dk2wn95.386

for Win95) not available with the downloaded program (you can download

it here:&nbsp; <A HREF="javascript:if(confirm('ftp://ftp.kcc.co.uk/pub/kcml/windk2drivers/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='ftp://ftp.kcc.co.uk/pub/kcml/windk2drivers/'" tppabs="ftp://ftp.kcc.co.uk/pub/kcml/windk2drivers/">Bdk2wn32.exe</A> 720Kb -: ). If its installation failed, you can do it manually as per follows:</TT>

<BR><TT>Open 'system.ini'.Find the section of system.ini which is headed

[386Enh]. Insert the following line into this section:&nbsp;&nbsp;</TT>

<BR><TT>&nbsp; device=C:\AIDAMGE\DK2WN95.386&nbsp;</TT>

<BR><TT>If you changed the installation directory from C:\AIDAMAGE, you

should adjust the path in the above line accordingly.</TT>



<P><TT>A quick look at AiDamage doc gives us some infos about the protection:</TT>

<BR><I><TT>On the first time of starting, you will be requested to enter

a code.&nbsp; This code is needed before the dongle can be activated.&nbsp;

To obtain the code contact Ai Training Services on 01452 862798 and ask

for a code.&nbsp; You will also need to advise the operator of the number

quoted in the box. (Marked User code:)&nbsp;</TT></I>

<BR><I><TT>Type in the code supplied EXACTLY as given.&nbsp; Press 'OK'

and the dongle will be activated and Ai Damage will start. To activate

the dongle contact AiTS with the code displayed on the Enable Dongle dialog.&nbsp;

You will be given a return code which you should enter, exactly as quoted.&nbsp;

Once entered press ÎOKÌ and Ai Damage will start properly. If you fail

to enter the code as given, Ai Damage will not function.</TT></I>

<BR><I><TT>You should not need to enter any other codes until the dongle

is automatically de-activated at the expiry of your licence. Ai Damage

will function for three months following the expiry of the licence.&nbsp;

Any attempt beyond this date to start the program will fail., with the

display of this dialog.</TT></I>

<BR><I><TT>If you try and remove the dongle whilst Ai Damage is running,

then Ai Damage will detect this and close down.&nbsp; You may not have

any opportunity to save your data once the dongle has been removed.&nbsp;

Replacing the dongle will have no effect.&nbsp; You must re-start Ai Damage

and re-enter any of the lost data.&nbsp;</TT></I>

<BR><TT><I>On the expiry of the annual licence, the dongle will detect

this condition and cause Ai Damage to display this dialog box.&nbsp; You

need to follow the instructions on screen, and your dongle will be activated

for further use.</I>&nbsp;</TT>



<P><TT>As you can see, if you are working with AiDamage and then, by mistake,

remove or disconnect the dongle, ALL your work will be lost! Nice people...</TT>

<BR><TT>That's not all:</TT>

<BR><I><TT>Ai Damage will run under Windows NT.&nbsp; However it has not

been tested fully under NT and support with configuration of NT is not

provided as part of your licence agreement.</TT></I>

<BR><TT>And finally:</TT>

<BR><I><TT>It has been noticed that with some hardware / printer configurations

the presence of the dongle can cause corruption of the output to the printer.</TT></I>



<P><TT>What an encouragement to buy this soft!!</TT>



<P><TT>So, let's crack it "black &amp; blue" ; this will solve some of

those troubleshootings.&nbsp;</TT>



<P><TT>Run the program and you get the message box:&nbsp;</TT>

<BR><TT>DONGLE ERROR - Cannot find a valid dongle&nbsp;</TT>



<P><TT>Disasm the main exe file (<I>aidamage.exe</I> 341Kb)with W32dasm85.</TT>

<BR><TT>I simple search through the String Datas References will give us

all we need:</TT>

<BR><TT>&nbsp;</TT>

<BR><TT>:0041257C FF1544EE4200&nbsp;&nbsp;&nbsp; MSVCRT40._mbscmp&nbsp;</TT>

<BR><TT>:00412582 83C408&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

add esp, 00000008</TT>

<BR><TT>:00412585 85C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

test eax, eax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Is_Driver_Loaded?</FONT></TT>

<BR><TT>:00412587 7425&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

je 004125AE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Jump if OK</FONT></TT>

<BR><TT>:00412589 8B4DF0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

mov ecx, dword ptr [ebp-10]</TT>

<BR><TT>:0041258C E8DF0E0000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; call 00413470&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; "Dongle driver not loaded"</FONT></TT>

<BR><TT>:00412591 85C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

test eax, eax&nbsp;</TT>

<BR><TT>:00412593 0F8487FEFFFF&nbsp;&nbsp;&nbsp; je 00412420&nbsp;</TT>

<BR><TT>:00412599 8B4DF0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

mov ecx, dword ptr [ebp-10]&nbsp;</TT>

<BR><TT>:0041259C E8FF100000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; call 004136A0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; "Unable to read license info"</FONT></TT>

<BR><TT>:004125A1 85C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

test eax, eax&nbsp;</TT>

<BR><TT>:004125A3 0F85C9000000&nbsp;&nbsp;&nbsp; jne 00412672&nbsp;</TT>

<BR><TT>:004125A9 E972FEFFFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jmp 00412420&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Exit</FONT>&nbsp;</TT>

<BR><TT>:004125AE 6A00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push 00000000&nbsp;</TT>

<BR><TT>:004125B0 8D8D3CFFFFFF&nbsp;&nbsp;&nbsp; lea ecx, dword ptr [ebp+FFFFFF3C]&nbsp;</TT>

<BR><TT>:004125B6 E8A5030100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; call 00422960&nbsp;</TT>

<BR><TT>:004125BB C745FC04000000&nbsp; mov [ebp-04], 00000004&nbsp;</TT>

<BR><TT>:004125C2 8D8D3CFFFFFF&nbsp;&nbsp;&nbsp; lea ecx, dword ptr [ebp+FFFFFF3C]&nbsp;</TT>

<BR><TT>:004125C8 E809080100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MFC40.MFC40:NoName0113&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Message Box:"Please Enter your password"</FONT>&nbsp;</TT>

<BR><TT>:004125CD 83F801&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

cmp eax, 00000001&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; "OK" pressed?</FONT>&nbsp;</TT>

<BR><TT>:004125D0 0F85AD040000&nbsp;&nbsp;&nbsp; jne 00412A83&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; if not=>Exit</FONT>&nbsp;</TT>

<BR><TT>:004125D6 682CC24200&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push 0042C22C&nbsp;</TT>

<BR><TT>:004125DB 8D4DE4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

lea ecx, dword ptr [ebp-1C] <FONT COLOR="#3333FF">; Store our password</FONT></TT>

<BR><TT>:004125DE E833070100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MFC40.MFC40:NoName0081&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Calculate correct password</FONT></TT>

<BR><TT>:004125E3 C645FC05&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov

[ebp-04], 05&nbsp;</TT>

<BR><TT>:004125E7 8B459C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

mov eax, dword ptr [ebp-64] <FONT COLOR="#3333FF">; Store correct password

in eax</FONT></TT>

<BR><TT>:004125EA 8B4DE4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

mov ecx, dword ptr [ebp-1C] <FONT COLOR="#3333FF">; Store our password

in ecx</FONT></TT>

<BR><TT>:004125ED 50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push eax&nbsp;</TT>

<BR><TT>:004125EE 51&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push ecx&nbsp;</TT>

<BR><TT>:004125EF FF1544EE4200&nbsp;&nbsp;&nbsp; MSVCRT40._mbscmp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Compare both</FONT>&nbsp;</TT>

<BR><TT>:004125F5 83C408&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

add esp, 00000008&nbsp;</TT>

<BR><TT>:004125F8 85C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

test eax, eax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Is_Password_OK?</FONT>&nbsp;</TT>

<BR><TT>:004125FA 7428&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

je 00412624&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Yes, jump and go ahead...&nbsp;</FONT></TT>

<BR><TT>:004125FC 6A00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push 00000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; otherwise...</FONT>&nbsp;</TT>

<BR><TT>:004125FE 6A30&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push 00000030&nbsp;</TT>

<BR><TT>...&nbsp;</TT>

<BR><TT>:00412600 6800C24200&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push 0042C200&nbsp;</TT>

<BR><TT>:0041261F E9FCFDFFFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jmp 00412420&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; "Password incorrect, closing down"</FONT></TT>



<P><TT><FONT COLOR="#000000">A lot of interesting things are going on here.

I tried to nicely reververse engineer this routine but the program acted

so strangely that I prefer to use a brute force approach.</FONT></TT>

<BR><TT><FONT COLOR="#000000">What we are going to do is:</FONT></TT>

<BR><TT><FONT COLOR="#000000">-force the program to recognize the dongle

driver (even if it is not loaded)</FONT></TT>

<BR><TT><FONT COLOR="#000000">-Get rid of the "Enter your password" message

box.</FONT></TT>

<BR><TT><FONT COLOR="#000000">-Make it believe we typed a password and

pressed "OK"</FONT></TT>

<BR><TT><FONT COLOR="#000000">-Feed it with the right password</FONT></TT>

<BR><TT><FONT COLOR="#000000">-Force it to accept it</FONT></TT>



<P><TT><FONT COLOR="#000000">Changed offset are shown in </FONT><FONT COLOR="#CC0000">red</FONT><FONT COLOR="#000000">:</FONT></TT>



<P><TT>:0041257C FF1544EE4200&nbsp;&nbsp;&nbsp; MSVCRT40._mbscmp</TT>

<BR><TT>:00412582 83C408&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

add esp, 00000008</TT>

<BR><TT><FONT COLOR="#CC0000">:00412585</FONT> 33C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

xor eax, eax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Driver_Always_Loaded</FONT></TT>

<BR><TT>:00412587 7425&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

je 004125AE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Jump</FONT></TT>

<BR><TT>:00412589 8B4DF0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

mov ecx, dword ptr [ebp-10]</TT>

<BR><TT>:0041258C E8DF0E0000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; call 00413470&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TT>

<BR><TT>:00412591 85C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

test eax, eax</TT>

<BR><TT>:00412593 0F8487FEFFFF&nbsp;&nbsp;&nbsp; je 00412420</TT>

<BR><TT>:00412599 8B4DF0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

mov ecx, dword ptr [ebp-10]</TT>

<BR><TT>:0041259C E8FF100000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; call 004136A0</TT>

<BR><TT>:004125A1 85C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

test eax, eax</TT>

<BR><TT>:004125A3 0F85C9000000&nbsp;&nbsp;&nbsp; jne 00412672</TT>

<BR><TT>:004125A9 E972FEFFFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jmp 00412420&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TT>

<BR><TT>:004125AE 6A00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push 00000000</TT>

<BR><TT>:004125B0 8D8D3CFFFFFF&nbsp;&nbsp;&nbsp; lea ecx, dword ptr [ebp+FFFFFF3C]&nbsp;</TT>

<BR><TT>:004125B6 E8A5030100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; call 00422960&nbsp;</TT>

<BR><TT>:004125BB C745FC04000000&nbsp; mov [ebp-04], 00000004&nbsp;</TT>

<BR><TT>:004125C2 8D8D3CFFFFFF&nbsp;&nbsp;&nbsp; lea ecx, dword ptr [ebp+FFFFFF3C]&nbsp;</TT>

<BR><TT><FONT COLOR="#CC0000">:004125C8</FONT> B801000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

mov eax,000000001&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; No more Message Box</FONT></TT>

<BR><TT>:004125CD 83F801&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

cmp eax, 00000001&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; "OK" pressed</FONT>&nbsp;</TT>

<BR><TT>:004125D0 0F85AD040000&nbsp;&nbsp;&nbsp; jne 00412A83</TT>

<BR><TT>:004125D6 682CC24200&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push 0042C22C&nbsp;</TT>

<BR><TT>:004125DB 8D4DE4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

lea ecx, dword ptr [ebp-1C] <FONT COLOR="#3333FF">; Store our password</FONT></TT>

<BR><TT>:004125DE E833070100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MFC40.MFC40:NoName0081&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Calculate correct password</FONT></TT>

<BR><TT>:004125E3 C645FC05&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov

[ebp-04], 05&nbsp;</TT>

<BR><TT>:004125E7 8B459C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

mov eax, dword ptr [ebp-64] <FONT COLOR="#3333FF">; Store correct password

in eax</FONT></TT>

<BR><TT><FONT COLOR="#CC0000">:004125EA</FONT> 8B4D9C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

mov ecx, dword ptr [ebp-64] <FONT COLOR="#3333FF">; Store correct password

in ecx</FONT></TT>

<BR><TT>:004125ED 50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push eax&nbsp;</TT>

<BR><TT>:004125EE 51&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push ecx&nbsp;</TT>

<BR><TT>:004125EF FF1544EE4200&nbsp;&nbsp;&nbsp; MSVCRT40._mbscmp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Compare both</FONT>&nbsp;</TT>

<BR><TT>:004125F5 83C408&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

add esp, 00000008&nbsp;</TT>

<BR><TT>:004125F8 85C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

test eax, eax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Password_ALWAYS_OK</FONT></TT>

<BR><TT>:004125FA 7428&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

je 00412624&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; jump and go ahead.&nbsp;</FONT></TT>

<BR><TT>:004125FC 6A00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push 00000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Will never reach this part.</FONT></TT>

<BR><TT>:004125FE 6A30&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push 00000030&nbsp;</TT>

<BR><TT>...&nbsp;</TT>

<BR><TT>:00412600 6800C24200&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push 0042C200&nbsp;</TT>

<BR><TT>:0041261F E9FCFDFFFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jmp 00412420</TT>



<P><TT><FONT COLOR="#000000">There are still few enhancements to do because

running the program with these changes will give you the following message:</FONT></TT>

<BR><I><TT><FONT COLOR="#000000">"This dongle does not support AIDamage"</FONT></TT></I>



<P><TT><FONT COLOR="#000000">Back to W32dasm85 we quickly find the problem:</FONT></TT>



<P><TT><FONT COLOR="#000000">:0041293A FF1544EE4200&nbsp;&nbsp;&nbsp; MSVCRT40._mbscmp</FONT></TT>

<BR><TT><FONT COLOR="#000000">:00412940 83C408&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

add esp, 00000008</FONT></TT>

<BR><TT><FONT COLOR="#000000">:00412943 85C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

test eax, eax</FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Is_Dongle_OK?</FONT></TT>

<BR><TT><FONT COLOR="#000000">:00412945 7420&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

je 00412967&nbsp;&nbsp;</FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Yes, jump otherwise...</FONT></TT>

<BR><TT><FONT COLOR="#000000">:00412947 8B4DF0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

mov ecx, dword ptr [ebp-10]</FONT></TT>

<BR><TT><FONT COLOR="#000000">:0041294A E8F10B0000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

call 00413540</FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; "This dongle doesn't support..."</FONT></TT>

<BR>&nbsp;



<P><TT><FONT COLOR="#000000">We notice that the program is always checking

if the dongle is still present:</FONT></TT>



<P><TT><FONT COLOR="#000000">:0041450A FF1544EE4200&nbsp;&nbsp;&nbsp; MSVCRT40._mbscmp</FONT></TT>

<BR><TT><FONT COLOR="#000000">:00414510 83C408&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

add esp, 00000008</FONT></TT>

<BR><TT><FONT COLOR="#000000">:00414513 85C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

test eax, eax</FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Is_Dongle_Still_Connected?</FONT></TT>

<BR><TT><FONT COLOR="#000000">:00414515 7511&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

jne 00414528</FONT></TT>

<BR><TT><FONT COLOR="#000000">:00414517 33C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

xor eax, eax&nbsp;</FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Good_Guy</FONT></TT>

<BR><TT><FONT COLOR="#000000">:00414519 8B4DF4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

mov ecx, dword ptr [ebp-0C]</FONT></TT>

<BR><TT><FONT COLOR="#000000">:0041451C 64890D00000000&nbsp; mov dword

ptr fs:[00000000], ecx</FONT></TT>

<BR><TT><FONT COLOR="#000000">:00414523 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

pop esi</FONT></TT>

<BR><TT><FONT COLOR="#000000">:00414524 8BE5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

mov esp, ebp</FONT></TT>

<BR><TT><FONT COLOR="#000000">:00414526 5D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

pop ebp</FONT></TT>

<BR><TT><FONT COLOR="#000000">:00414527 C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

ret</FONT></TT>

<BR><TT><FONT COLOR="#000000">:00414528 685CC64200&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push 0042C65C</FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; "Dongle is no longer connected"</FONT></TT>



<P><TT><FONT COLOR="#000000">For those 2 checks, you just have to patch

both <I>test eax,eax</I>.</FONT></TT>

<BR>&nbsp;



<P><TT><FONT COLOR="#000000">Finally, I deeper look at the ASM listing

and you'll find some other error messages:</FONT></TT>



<P><I><TT><FONT COLOR="#000000">"Your dongle has not been updated"</FONT></TT></I>

<BR><TT><FONT COLOR="#000000">x-refs:</FONT></TT>

<BR><TT><FONT COLOR="#000000">:00413C77</FONT></TT>

<BR><TT><FONT COLOR="#000000">:00413F47</FONT></TT>

<BR><TT><FONT COLOR="#000000">:00413FF0</FONT></TT>



<P><I><TT><FONT COLOR="#000000">"Invalid enable code, closing down"</FONT></TT></I>

<BR><TT><FONT COLOR="#000000">x-refs:</FONT></TT>

<BR><TT><FONT COLOR="#000000">:00413BFC</FONT></TT>

<BR><TT><FONT COLOR="#000000">:00413C05</FONT></TT>



<P><I><TT><FONT COLOR="#000000">"Your licence has expired."</FONT></TT></I>

<BR><TT><FONT COLOR="#000000">X-Ref:</FONT></TT>

<BR><TT><FONT COLOR="#000000">:00413966</FONT></TT>



<P><TT><FONT COLOR="#000000">I didn't patch those occurences as the program

worked well. I put some BPX at those offsets but SoftICE never broke (even

when changing the OS date). So I just assume the program may check inside

the dongle to see if the license has expired or not but since we forced

it to accept the dongle we may not need to patch them.</FONT></TT>

<BR><TT><FONT COLOR="#000000">Anyway, now you won't loose any data if you

have a dongle connected or not and you can print safely!</FONT></TT>

<BR>&nbsp;

<BR><TT>Note: you can remove the DK2 DESkey driver, it is not needed any

more.</TT>

<BR>

<HR WIDTH="100%">

<BR><B><U><FONT SIZE=+2>Electro Chemistry (12 Nov.1997 version)</FONT></U></B>

<BR><B>-Description:</B>

<BR>Electrochemistry Software.

<BR><B>-OS:</B>

<BR>Win3.xx/95

<BR><B>-Protection:</B>

<BR>Dongle (parallel ). Driver: <I>Key.dll</I> (c:\windows\system).

<BR><B>-Misc.:</B>

<BR>Run as a DEMO if no dongle detected (Nagscreen, file and print operations

are disabled).



<P><TT>During its installation, this Visual Basic 3 soft added a <I>key.dll</I>

(18Kb) file to the <I>windows/system</I> directory.</TT>

<BR><TT>Though we could use Dodi's VB discompiler to disasm the main executable

(<I>ecprog.exe</I> 231Kb) and find all references to the dongle through

the source code, a live approach will be enough to get rid of the protection.</TT>



<P><TT>Running the program will display a Nagscreen:</TT>

<BR><I><TT>"The software key was not detected! The software will run in

demonstration mode only"</TT></I>



<P><TT>With SoftICE:</TT>

<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp; BPIO -H 378</TT>

<BR><TT>Run <I>ecprog.exe</I> and SoftICE pops. We are inside M<I>ake.dll</I>,

an Exported function from <I>Key.dll</I>.</TT>

<BR><TT>Press &lt;F12> 3 times, and you can't miss the dongle protection:</TT>

<BR>&nbsp;



<P><TT>.000105C8: E88EFE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; call&nbsp; .000010459&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Check I/O</FONT></TT>

<BR><TT>.000105CB: 08C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; or&nbsp;&nbsp;&nbsp;&nbsp;

al,al&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Is_Dongle_OK?</FONT></TT>

<BR><TT>.000105CD: 7506&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jne&nbsp;&nbsp;

.0000105D5</TT>

<BR><TT>.000105CF: C646FF00&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp; b,[bp][-0001],000&nbsp;

<FONT COLOR="#3333FF">; Bad_Guy_Flag</FONT></TT>

<BR><TT>.000105D3: EB04&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jmps&nbsp;

.0000105D9</TT>

<BR><TT>.000105D5: C646FF01&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp; b,[bp][-0001],001&nbsp;

<FONT COLOR="#3333FF">; Good_Guy_Flag</FONT></TT>

<BR><TT>.000105D9: 8A46FF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;

al,[bp][-0001]&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">; Store Flag

in AL</FONT></TT>

<BR><TT>.000105DC: C9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

leave</TT>

<BR><TT>.000105DD: CA0C00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; retf&nbsp;&nbsp;

0000C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Back to caller</FONT></TT>



<P><TT>This routine is very important:</TT>

<BR><TT>You'll find it in most stupid dongle programs you'll have to crack,

so get familiar with it!</TT>



<P><TT>.0001004B: 9AFFFF0000&nbsp; call&nbsp;&nbsp; 001:004EE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Call the above routine&nbsp;</FONT></TT>

<BR><TT>.00010050: 08C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; or&nbsp;&nbsp;&nbsp;&nbsp;

al,al&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Good_Guy_flag set?</FONT></TT>

<BR><TT>.00010052: 7407&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; je&nbsp;&nbsp;&nbsp;

.00001005B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TT>

<BR><TT>.00010054: C746FC0100&nbsp; mov&nbsp;&nbsp;&nbsp; w,[bp][-0004],00001

<FONT COLOR="#3333FF">; Full_Program_Flag</FONT></TT>

<BR><TT>.00010059: EB05&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jmps&nbsp;

.000010060</TT>

<BR><TT>.0001005B: 31C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; xor&nbsp;&nbsp;&nbsp;

ax,ax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Demo_Program_Flag</FONT></TT>

<BR><TT>.0001005D: 8946FC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;

[bp][-0004],ax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">; Bad_Guy

=> Xor AX</FONT></TT>

<BR><TT>.00010060: 8B46FC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;

ax,[bp][-0004]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">; Good_Guy=>

AX=0x01</FONT></TT>

<BR><TT>.00010063: 5F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

pop&nbsp;&nbsp;&nbsp; di</TT>

<BR><TT>.00010064: 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

pop&nbsp;&nbsp;&nbsp; si</TT>

<BR><TT>.00010065: 8D66FE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lea&nbsp;&nbsp;&nbsp;

sp,[bp][-0002]</TT>

<BR><TT>.00010068: 1F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

pop&nbsp;&nbsp;&nbsp; ds</TT>

<BR><TT>.00010069: 5D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

pop&nbsp;&nbsp;&nbsp; bp</TT>

<BR><TT>.0001006A: 4D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

dec&nbsp;&nbsp;&nbsp; bp</TT>

<BR><TT>.0001006B: CB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

retf</TT>



<P><TT>If you disasm the DLL, you'll see that there is only 1 x-ref for

both routine: the program just checks for the dongle at the very beginning

but will not during its execution (but it will check the Full_Program/Demo_Program

flag).</TT>

<BR><TT>&nbsp;</TT>

<BR><TT>You can patch the conditional jump at 00010052 or the first routine....

there are plenty of ways to do so.</TT>

<BR><TT>That's all for this dongle.</TT>

<BR>&nbsp;

<HR WIDTH="100%">



<P><B><U><FONT SIZE=+2>IPLab v1.7</FONT></U></B>

<BR><B>-Description:</B>

<BR>Scientific image analysis program.

<BR><B>-OS:</B>

<BR>Win95/NT4

<BR><B>-Protection:</B>

<BR>Dongle (parallel ). Driver: <I>Sentinel.vxd</I>.

<BR><B>-Misc.:</B>

<BR>Does NOT run if no dongle detected + SetUp password protected.



<P><TT>The Setup will prompt you for a password. Let's crack it:</TT>

<BR><TT>&nbsp;&nbsp; BPX DialogBoxParam</TT>

<BR><TT>Type in any password + &lt;Enter>.</TT>

<BR><TT>SoftICE pops:</TT>

<BR><TT>&nbsp;&nbsp; &lt;F11></TT>

<BR><TT>You'll get the "Incorrect Password" message. Press &lt;OK>.</TT>

<BR><TT>&nbsp;&nbsp; &lt;F12></TT>

<BR><TT>Now just look at the end of the routine:</TT>



<P><TT>xxxx:4494 B80100&nbsp;&nbsp; mov ax,0001&nbsp; <FONT COLOR="#3333FF">;

SetUP cancelled</FONT></TT>

<BR><TT>xxxx:4497 EB02&nbsp;&nbsp;&nbsp;&nbsp; jmp 449B</TT>

<BR><TT>xxxx:4499 33C0&nbsp;&nbsp;&nbsp;&nbsp; xor ax,ax&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Install program</FONT></TT>

<BR><TT>xxxx:449B 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop si</TT>

<BR><TT>xxxx:449C 5F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop di</TT>

<BR><TT>xxxx:449D C9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; leave</TT>

<BR><TT>xxxx:449E CB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ret</TT>



<P><TT>Just patch the <I>mov ax,0001 </I>so that the Setup will think you

have typed the right password.</TT>



<P><TT>The program will be installed in the c:\IPLabDir directory (you

can't choose another destination directory).</TT>

<BR><TT>Running the main exe file <I>IPLab.exe</I> (1.22 Mb) will display:</TT>

<BR><TT>"KEY NOT FOUND"</TT>



<P><TT>WDasm it and here is what we find:</TT>



<P><TT>:0040D626 E815630200&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

call 00433940&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Check_If_Dongle_OK</FONT></TT>

<BR><TT>:0040D62B 85C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

test eax, eax</TT>

<BR><TT>:0040D62D 7516&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

jne 0040D645&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Good_Guy</FONT></TT>

<BR><TT>:0040D62F 56&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push esi</TT>

<BR><TT>:0040D630 56&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push esi</TT>

<BR><TT>:0040D631 68A8C64B00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push 004BC6A8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; "Key not found" + Exit</FONT></TT>

<BR><TT>:0040D636 E8A5E50400&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

MFC40.MFC40:NoName0029</TT>

<BR><TT>:0040D63B C7837C02000002000000&nbsp;&nbsp;&nbsp; mov dword ptr

[ebx+0000027C], 2</TT>

<BR><TT>:0040D645 8D4DC0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

lea ecx, dword ptr [ebp-40]</TT>



<P><TT>Just make it always jump.</TT>



<P><TT>When running, the program will check is the key is still plugged

in:</TT>



<P><TT>* Referenced by a CALL at Addresses :0043379C, :0043BCD1, :0043BD23,

:0043BD75, :0043BDC3, :0044CF15</TT>

<BR><TT>:00433AB0 6A00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push 00000000</TT>

<BR><TT>:00433AB2 6A00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push 00000000</TT>

<BR><TT>:00433AB4 6894E14B00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push 004BE194&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; "Key Missing"</FONT>&nbsp;</TT>



<P><TT>It is called by 6 different routines. Here is just the first one

of them (they all use the same following piece of code):</TT>



<P><TT>:00433787 E894830000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

call 0043BB20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Check // port</FONT></TT>

<BR><TT>:0043378C 85C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

test eax, eax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Is_Dongle_OK?</FONT></TT>

<BR><TT>:0043378E 740C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

je 0043379C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Bad_Guy_Jump</FONT></TT>

<BR><TT>:00433790 99&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

cdq</TT>

<BR><TT>:00433791 B907000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

mov ecx, 00000007</TT>

<BR><TT>:00433796 F7F9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

idiv ecx</TT>

<BR><TT>:00433798 85D2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

test edx, edx</TT>

<BR><TT>:0043379A 7425&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

je 004337C1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Good_Guy jump</FONT></TT>

<BR><TT>* Referenced by (C)onditional Jump :0043378E</TT>

<BR><TT>:0043379C E80F030000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

call 00433AB0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; "Key Missing" + Exit</FONT></TT>

<BR><TT>:004337A1 6A00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push 00000000</TT>

<BR><TT>:004337A3 6A01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push 00000001</TT>



<P><TT>This routine check the parallel port by calling offset :0043BB20.

The 5 other similar ones call 4 different routines:</TT>



<P><TT>1) 0043BB20&nbsp;</TT>

<BR><TT>2) 0043BC20</TT>

<BR><TT>3) 0043BB60&nbsp;</TT>

<BR><TT>4) 0043BBB0&nbsp;</TT>



<P><TT>Now let's see those 4 routines that call the Sentinel driver:</TT>

<BR><TT>1)</TT>

<BR><TT>:0043BB20 A1B4094C00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

mov eax, dword ptr [004C09B4]&nbsp;</TT>

<BR><TT>:0043BB25 0FBF00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

movsx eax, word ptr [eax]&nbsp;</TT>

<BR><TT>:0043BB28 99&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

cdq&nbsp;</TT>

<BR><TT>:0043BB29 33C2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

xor eax, edx&nbsp;</TT>

<BR><TT>:0043BB2B 2BC2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

sub eax, edx&nbsp;</TT>

<BR><TT>:0043BB2D 8B15BC094C00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

mov edx, dword ptr [004C09BC]&nbsp;</TT>

<BR><TT>:0043BB33 8BC8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

mov ecx, eax&nbsp;</TT>

<BR><TT>:0043BB35 0FBF02&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

movsx eax, word ptr [edx]&nbsp;</TT>

<BR><TT>:0043BB38 99&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

cdq&nbsp;</TT>

<BR><TT>:0043BB39 33C2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

xor eax, edx&nbsp;</TT>

<BR><TT>:0043BB3B 2BCA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

sub ecx, edx&nbsp;</TT>

<BR><TT>:0043BB3D 03C8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

add ecx, eax&nbsp;</TT>

<BR><TT>:0043BB3F 7512&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

jne 0043BB53&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Make it always jump 43BB41</FONT></TT>

<BR><TT>:0043BB41 FF1580794C00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

MSVCRT40.rand&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<FONT COLOR="#3333FF">

; Good_Guy</FONT></TT>

<BR><TT>:0043BB47 8D0CC500000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

lea ecx, dword ptr [8*eax+00000000]&nbsp;</TT>

<BR><TT>:0043BB4E 2BC8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

sub ecx, eax&nbsp;</TT>

<BR><TT>:0043BB50 8BC1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

mov eax, ecx</TT>

<BR><TT>:0043BB52 C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

ret&nbsp;</TT>

<BR><TT>* Referenced by a jump:0043BB3F(C)&nbsp;</TT>

<BR><TT>:0043BB53 33C9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

xor ecx, ecx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Bad_Guy</FONT></TT>

<BR><TT>:0043BB55 8BC1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

mov eax, ecx&nbsp;</TT>

<BR><TT>:0043BB57 C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

ret&nbsp;</TT>



<P><TT>2)</TT>

<BR><TT>:0043BC20 53&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push ebx</TT>

<BR><TT>:0043BC21 56&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push esi</TT>

<BR><TT>:0043BC22 668B5C240C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

mov bx, word ptr [esp+0C]</TT>

<BR><TT>:0043BC27 57&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push edi</TT>

<BR><TT>:0043BC28 33FF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

xor edi, edi</TT>

<BR><TT>...</TT>

<BR><TT>:0043BC54 85FF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

test edi, edi</TT>

<BR><TT>:0043BC56 750E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

jne 0043BC66&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Make it always jump 43BC58&nbsp;</FONT></TT>

<BR><TT>:0043BC58 FFD6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

call esi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<FONT COLOR="#3333FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

; Good_Guy</FONT></TT>

<BR><TT>:0043BC5A 40&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

inc eax</TT>

<BR><TT>:0043BC5B 5F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

pop edi</TT>

<BR><TT>:0043BC5C 8BC8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

mov ecx, eax</TT>

<BR><TT>:0043BC5E 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

pop esi</TT>

<BR><TT>:0043BC5F C1E003&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

shl eax, 03</TT>

<BR><TT>:0043BC62 5B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

pop ebx</TT>

<BR><TT>:0043BC63 2BC1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

sub eax, ecx</TT>

<BR><TT>:0043BC65 C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

ret</TT>

<BR><TT>* Referenced by a (C)onditional Jump :0043BC56</TT>

<BR><TT>:0043BC66 33C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

xor eax, eax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Bad_Guy</FONT></TT>

<BR><TT>:0043BC68 5F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

pop edi</TT>

<BR><TT>:0043BC69 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

pop esi</TT>

<BR><TT>:0043BC6A 5B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

pop ebx</TT>

<BR><TT>:0043BC6B C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

ret</TT>



<P><TT>3)</TT>

<BR><TT>:0043BB60 A1B8094C00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

mov eax, dword ptr [004C09B8]</TT>

<BR><TT>:0043BB65 0FBF00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

movsx eax, word ptr [eax]</TT>

<BR><TT>...</TT>

<BR><TT>:0043BB7F A1B0094C00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

mov eax, dword ptr [004C09B0]</TT>

<BR><TT>:0043BB84 0FBF00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

movsx eax, word ptr [eax]</TT>

<BR><TT>:0043BB87 99&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

cdq</TT>

<BR><TT>:0043BB88 33C2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

xor eax, edx</TT>

<BR><TT>:0043BB8A 2BCA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

sub ecx, edx</TT>

<BR><TT>:0043BB8C 03C8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

add ecx, eax</TT>

<BR><TT>:0043BB8E 7512&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

jne 0043BBA2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Make it always jump 43BB90</FONT></TT>

<BR><TT>:0043BB90 FF1580794C00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

MSVCRT40.rand&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<FONT COLOR="#3333FF">

; Good_Guy</FONT></TT>

<BR><TT>:0043BB96 8D0CC500000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

lea ecx, dword ptr [8*eax+00000000]</TT>

<BR><TT>:0043BB9D 2BC8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

sub ecx, eax</TT>

<BR><TT>:0043BB9F 8BC1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

mov eax, ecx</TT>

<BR><TT>:0043BBA1 C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

ret</TT>

<BR><TT>* Referenced by a (C)onditional Jump :0043BB8E(C)</TT>

<BR><TT>:0043BBA2 33C9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

xor ecx, ecx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Bad_Guy</FONT></TT>

<BR><TT>:0043BBA4 8BC1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

mov eax, ecx</TT>

<BR><TT>:0043BBA6 C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

ret</TT>



<P><TT>4)</TT>

<BR><TT>:0043BBB0 A1B4094C00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

mov eax, dword ptr [004C09B4]</TT>

<BR><TT>:0043BBB5 0FBF00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

movsx eax, word ptr [eax]</TT>

<BR><TT>:0043BBB8 99&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

cdq</TT>

<BR><TT>...</TT>

<BR><TT>:0043BBF6 33C2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

xor eax, edx</TT>

<BR><TT>:0043BBF8 2BCA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

sub ecx, edx</TT>

<BR><TT>:0043BBFA 03C8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

add ecx, eax</TT>

<BR><TT>:0043BBFC 7512&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

jne 0043BC10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Make it always jump 43BBFE&nbsp;</FONT></TT>

<BR><TT>:0043BBFE FF1580794C00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

MSVCRT40.rand&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<FONT COLOR="#3333FF">

; Good_Guy</FONT></TT>

<BR><TT>:0043BC04 8D0CC500000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

lea ecx, dword ptr [8*eax+00000000]</TT>

<BR><TT>:0043BC0B 2BC8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

sub ecx, eax</TT>

<BR><TT>:0043BC0D 8BC1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

mov eax, ecx</TT>

<BR><TT>:0043BC0F C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

ret</TT>

<BR><TT>* Referenced by a (C)onditional Jump :0043BBFC(C)</TT>

<BR><TT>:0043BC10 33C9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

xor ecx, ecx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Bad_Guy</FONT></TT>

<BR><TT>:0043BC12 8BC1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

mov eax, ecx</TT>

<BR><TT>:0043BC14 C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

ret</TT>



<P><TT>That was just another stupid protection which didn't need any dongle.

A simple 'password protected' program or a good .Reg/.Key file would have

done the same (and would have save money to those programers -:).</TT>



<P>

<HR WIDTH="100%">



<P><A NAME="read_and_forget"></A><B><U><FONT SIZE=+2>DigiSHOW.vld v1.7</FONT></U></B>

<BR><B>-Description:</B>

<BR>Virtual Laser Disk program.

<BR><B>-OS:</B>

<BR>Win95

<BR><B>-Protection:</B>

<BR>Dongle (parallel ). Driver: <I>DK47wn32.dll</I>

<BR><B>-Misc.:</B>

<BR>Does NOT run if no dongle detected.

<BR>&nbsp;



<P><TT>Disasm the main exe (<I>vld.exe</I> 145Kb).</TT>

<BR><TT>There're no words to describe the following; <B>just read it and

forget it</B>.</TT>

<BR><TT>&nbsp;&nbsp;</TT>



<P><TT>:00405E4F E8ECD7FFFF&nbsp;&nbsp;&nbsp; call 00403640&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Get_That_stupid_dongle_driver</FONT></TT>

<BR><TT>:00405E54 83F801&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cmp

eax, 00000001&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Is_Dongle_OK?</FONT></TT>

<BR><TT>:00405E57 0F8515010000&nbsp; jne 00405F72&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Jump if not</FONT></TT>

<BR><TT>:00405E5D 8B44243C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov eax, dword

ptr [esp+3C]</TT>

<BR><TT>:00405E61 8B4C2430&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov ecx, dword

ptr [esp+30]&nbsp;</TT>

<BR><TT>...&nbsp;</TT>

<BR><TT>* Referenced by a (C)onditional Jump :00405E57(C)&nbsp;</TT>

<BR><TT>:00405F72 6A00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push 00000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; "The DigiSHOW.vld key</FONT>&nbsp;</TT>

<BR><TT>:00405F79 68F8824100&nbsp;&nbsp;&nbsp; push 004182F8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; has not been found"</FONT>&nbsp;</TT>

<BR><TT>&nbsp;&nbsp;</TT>



<P><TT>And now, ladies and gentlemen, <B>THE </B>CALL :&nbsp;</TT>

<BR><TT>&nbsp;</TT>

<BR><TT>* Referenced by a (C)onditional Jump :00405E57</TT>

<BR><TT>:00403640 81EC08080000&nbsp; sub esp, 00000808&nbsp;</TT>

<BR><TT>:00403646 56&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push esi&nbsp;</TT>

<BR><TT>:00403647 33F6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

xor esi, esi&nbsp;</TT>

<BR><TT>:00403649 E8C4490000&nbsp;&nbsp;&nbsp; <FONT COLOR="#CC0000">DK47wn32.DK47DriverInstalled&nbsp;

</FONT><FONT COLOR="#3333FF">; No comments</FONT>&nbsp;</TT>

<BR><TT>:0040364E 83F801&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cmp

eax, 00000001&nbsp;</TT>

<BR><TT>:00403651 7549&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

jne 0040369C&nbsp;</TT>

<BR><TT>:00403653 E8B4490000&nbsp;&nbsp;&nbsp; <FONT COLOR="#CC0000">DK47wn32.FindDK47&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

</FONT><FONT COLOR="#3333FF">; No comments</FONT>&nbsp;</TT>

<BR><TT>:00403658 83F801&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cmp

eax, 00000001&nbsp;</TT>

<BR><TT>:0040365B 753F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

jne 0040369C&nbsp;</TT>

<BR><TT>:0040365D 8D442404&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lea eax, dword

ptr [esp+04]&nbsp;</TT>

<BR><TT>:00403661 6806080000&nbsp;&nbsp;&nbsp; push 00000806</TT>

<BR><TT>:00403666 50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push eax</TT>

<BR><TT>:00403667 6A3B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push 0000003B</TT>

<BR><TT>:00403669 6A06&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push 00000006</TT>

<BR><TT>:0040366B 6A1E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push 0000001E</TT>

<BR><TT>:0040366D E894490000&nbsp;&nbsp;&nbsp; <FONT COLOR="#CC0000">DK47wn32.DK47ReadRandomNumbers

</FONT><FONT COLOR="#3333FF">; No comments</FONT></TT>

<BR><TT>:00403672 B847040000&nbsp;&nbsp;&nbsp; mov eax, 00000447</TT>

<BR><TT>:00403677 33C9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

xor ecx, ecx</TT>

<BR><TT>:00403679 8A4C0404&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov cl, byte ptr

[esp+eax+04]</TT>

<BR><TT>:0040367D 03F1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

add esi, ecx</TT>

<BR><TT>:0040367F 40&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

inc eax</TT>

<BR><TT>:00403680 3D06080000&nbsp;&nbsp;&nbsp; cmp eax, 00000806</TT>

<BR><TT>:00403685 7CF0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

jl 00403677</TT>

<BR><TT>:00403687 81FECAFE0100&nbsp; cmp esi, 0001FECA</TT>

<BR><TT>:0040368D 750D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

jne 0040369C</TT>

<BR><TT>:0040368F B801000000&nbsp;&nbsp;&nbsp; mov eax, 00000001&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Guess?</FONT></TT>

<BR><TT>:00403694 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

pop esi</TT>

<BR><TT>:00403695 81C408080000&nbsp; add esp, 00000808</TT>

<BR><TT>:0040369B C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

ret</TT>



<P><TT>* Referenced by a (C)onditional Jump :00403651, :0040365B, :0040368D</TT>

<BR><TT>:0040369C 33C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

xor eax, eax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Guess here too?</FONT>&nbsp;</TT>

<BR><TT>:0040369E 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

pop esi&nbsp;</TT>

<BR><TT>:0040369F 81C408080000&nbsp; add esp, 00000808&nbsp;</TT>

<BR><TT>:004036A5 C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

ret&nbsp;</TT>

<BR><TT>&nbsp;&nbsp;</TT>



<P><TT>Everything is here. I would insult you if I explained how to crack

this crap, so I will not.&nbsp;</TT>

<BR><TT>&nbsp;&nbsp;</TT>

<BR><TT>The Help/About menu displays:</TT>



<P><I><TT>DESIN &amp; CODING:</TT></I>

<BR><I><TT>Chris Fulton</TT></I>

<BR><I><TT>GRAPHICS:</TT></I>

<BR><I><TT>Chris Fulton</TT></I>

<BR><I><TT>MANUAL:</TT></I>

<BR><I><TT>Chris Fulton</TT></I>



<P><TT>Sorry, Chris, but you're an asshole: keep working on the Manual,

but for God's sake, just forget the Coding!&nbsp;</TT>

<BR><TT>&nbsp;</TT>

<BR>

<HR WIDTH="100%">



<P><B><U><FONT SIZE=+2>Axon Engineer Pro v2.11e</FONT></U></B>

<BR><B>-Description:</B>

<BR>Neurocellular modeling tool.

<BR><B>-OS:</B>

<BR>DOS/Win3.xx/Win95

<BR><B>-Protection:</B>

<BR>Dongle (parallel ). Driver: <I>Sentinel.vxd.</I>

<BR><B>-Misc.:</B>

<BR>The DOS .exe file Does NOT run if no dongle detected. InstallShield

password protected.



<P><TT>Crackers are very serious peoples, look: we are going to crack a

dongle protected cellular electrochemical dynamics simulator! Nice isn't

it? But don't worry, as usual the program is far more complicated to understand

than its dongle protection is.</TT>



<P><TT>Before downloading it, I read at Axon's home page the following:</TT>

<BR><TT>"<I>If you are not currently a licensed user of Axon Engineer,

the downloads below will be of no use to you since they require the presence

of a hardware key ('dongle') to run.</I></TT>

<BR><TT><I>If you are a licensed user of Axon Engineer Pro, you will need

a password to run the setup program for the upgrade.</I>"</TT>

<BR>&nbsp;



<P><TT>The setup (that stupid InstallShield Wizard) is protected with a

password. A simple BPX Lstrcmp will show you that you should better type

<I>'opengate1' </I>if you ever want to have the opportunity to install

this soft.</TT>



<P><TT>There are 2 .exe files:</TT>

<BR><TT>- aewin.exe (375Kb) for Window$</TT>

<BR><TT>- eapro.exe (400Kb) for DOS.</TT>



<P><TT>Strangely, the Windows' file doesn't seem to require any dongle

(or did I miss something??) but the DOS'one does. That's just because it

is much more sophisticated than <I>aewin.exe</I> which doesn't appear to

be able to create new file.</TT>

<BR><TT>Let's work on the DOS app. For this I would prefer to use Sourcer

7.0 but since +IDA Pro is an official +HCU tool we will use it for this

crack.</TT>



<P><TT>Running <I>eapro.exe</I> will display the following message (and

nearly crash your computer, BTW -:):</TT>

<BR><I><TT>'Hardware Key Violation'</TT></I>



<P><TT>Open it with IDA Pro and search for the string "key":</TT>

<BR><TT>&nbsp;&nbsp; ALT-B&nbsp;&nbsp;&nbsp;&nbsp; type=>&nbsp;&nbsp; "key"</TT>



<P><TT>IDA send you there:</TT>



<P><TT>dseg:019E aHardwareKeyVio db 'Hardware Key Violation',0 ; DATA XREF:

sub_0_0+1347</TT>

<BR><TT>&nbsp;</TT>

<BR><TT>Just click on the XREF:</TT>



<P><TT>000:1346 loc_0_1346:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

; CODE XREF: sub_0_0+35B</TT>

<BR><TT>000:1346&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push&nbsp;&nbsp;&nbsp; ds</TT>

<BR><TT>000:1347&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push&nbsp;&nbsp;&nbsp; <B>offset aHardwareKeyVio</B></TT>

<BR><TT>000:134A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push&nbsp;&nbsp;&nbsp; 0FFFFh</TT>

<BR><TT>000:134C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

call&nbsp;&nbsp;&nbsp; sub_D49_2</TT>

<BR><TT>000:1351&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

add&nbsp;&nbsp;&nbsp;&nbsp; sp, 6</TT>

<BR><TT>000:1354&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

jmp&nbsp;&nbsp;&nbsp;&nbsp; short loc_0_13A0</TT>



<P><TT>As there is only 1 XREF, click on it again&nbsp; and you'll get

what you were looking for:</TT>



<P><TT>000:034C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push&nbsp;&nbsp;&nbsp; ds</TT>

<BR><TT>000:034D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push&nbsp;&nbsp;&nbsp; offset aAxonEngineer</TT>

<BR><TT>000:0350&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

call&nbsp;&nbsp;&nbsp; sub_DED_28A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Check_Dongle</FONT></TT>

<BR><TT>000:0355&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

add&nbsp;&nbsp;&nbsp;&nbsp; sp, 4</TT>

<BR><TT>000:0358&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

cmp&nbsp;&nbsp;&nbsp;&nbsp; ax, 2231h&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Is_Dongle_OK?</FONT></TT>

<BR><TT>000:035B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

jnz&nbsp;&nbsp;&nbsp;&nbsp; loc_0_1346&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<FONT COLOR="#3333FF">&nbsp;&nbsp;

; Bad_Guy_jump</FONT></TT>

<BR><TT>000:035F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

imul&nbsp;&nbsp;&nbsp; bx, [bp+var_10], 46h</TT>



<P><TT>Here again, there's no need to tell you how to crack it.</TT>



<P>

<HR WIDTH="100%">



<P><B><U><FONT SIZE=+2>FTI/DOE v2.3.1.4</FONT></U></B>

<BR><B>-Description:</B>

<BR>Tools for performing the process of dynamic energy analysis.

<BR><B>-OS:</B>

<BR>DOS/Win3.xx/Win95/NeXTStep/VMS and most Unix systems.

<BR><B>-Protection:</B>

<BR>Dongle (parallel ). Driver: <I>none.</I>

<BR><B>-Misc.:</B>

<BR>The 2 main DOS .exe files do NOT run if no dongle detected

<BR>&nbsp;



<P><TT>For infos, here is the more complete description of this soft:</TT>

<BR><TT>'<I>This software enables architects and engineers to perform a

comprehensive analysis of dynamic heating and cooling loads, simulation

of heating and cooling distribution systems, modeling of equipment supplying

the required energy and calculation of the life-cycle costs of owning and

operating energy systems for buildings. The program can simulate hour-by-hour

performance for buildings ranging in size from a small one-room residence

to a large multi-storied structure for each of the 8760 hours in a year.</I></TT>

<BR><TT><I>FTI/DOE is based on the work conducted by the Simulation Research

Group at Lawrence Berkeley Laboratories (LBL).</I>'</TT>



<P><TT>I really have no use of this soft, but as this DOS app was written

in Fortran and as I like this language, I downloaded it. If you never saw

the source code of a file in Fortran, you can go to <A HREF="javascript:if(confirm('http://www.finite-tech.com/download.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.finite-tech.com/download.html'" tppabs="http://www.finite-tech.com/download.html">FTI/DOE

site</A> and download the source of one of the .exe of this program (the

'weather processor' file - <I>wth.exe</I>) and you'll see how beautiful

it looks!</TT>



<P><TT>The 2 main softs (<I>ble.exe</I> 1Mb and <I>sim.exe</I> 1.57Mb)

are dongle protected (own routines linked inside both programs) and will

display the following message:</TT>



<P><TT>'<I>Invalid Hardware Key or Key Error</I></TT>

<BR><I><TT>Check the key for proper installation</TT></I>

<BR><TT><I>...Exiting!!!</I>'</TT>



<P><TT>We will only have a look at <I>ble.exe</I> as both program use exactly

the same protection scheme.</TT>



<P><TT>BPIO -h 378 with SoftICE and run it. SoftICE pops, then &lt;P RET>

2 times and here we go:</TT>



<P><TT>0002B285: E873EBFFFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

call&nbsp;&nbsp; 000029DFD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">;

get dongle RetCode in ax</FONT></TT>

<BR><TT>0002B28A: 8BE5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

mov&nbsp;&nbsp;&nbsp; esp,ebp</TT>

<BR><TT>0002B28C: 25F0FFFFFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

and&nbsp;&nbsp;&nbsp; eax,0FFFFFFF0</TT>

<BR><TT>0002B291: 663B0500560800&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

cmp&nbsp;&nbsp;&nbsp; ax,[000085600]&nbsp;&nbsp; <FONT COLOR="#3333FF">;

compare to correct RetCode (0x8010)</FONT></TT>

<BR><TT>0002B298: 6693&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

xchg&nbsp;&nbsp; bx,ax</TT>

<BR><TT>0002B29A: 0F8502000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

jne&nbsp;&nbsp;&nbsp; 00002B2A2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Bad_Guy jump</FONT></TT>

<BR><TT>0002B2A0: 33C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

xor&nbsp;&nbsp;&nbsp; eax,eax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Clear ax for Good_Guy</FONT></TT>

<BR><TT>0002B2A2: 5A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

pop&nbsp;&nbsp;&nbsp; edx</TT>

<BR><TT>0002B2A3: 59&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

pop&nbsp;&nbsp;&nbsp; ecx</TT>

<BR><TT>0002B2A4: 5B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

pop&nbsp;&nbsp;&nbsp; ebx</TT>

<BR><TT>0002B2A5: C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

retn</TT>



<P><TT>A couple of &lt;P RET> later we have:</TT>



<P><TT>00032393: E88DB30300&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

call&nbsp;&nbsp; 00006D725&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; the caller</FONT></TT>

<BR><TT>00032398: 83C40C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

add&nbsp;&nbsp;&nbsp; esp,00C</TT>

<BR><TT>0003239B: F705E41C090001000000&nbsp; test&nbsp;&nbsp; d,[000091CE4],000000001</TT>

<BR><TT>000323A5: 753E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

jne&nbsp;&nbsp;&nbsp; 0000323E5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; make it always jump</FONT></TT>



<P><TT>Again I just can't believe it: those guys wrote a sophisticated

soft, powerful and reliable with a complicated language (Fortran) but were

just unable to write a good protection scheme!</TT>

<BR>&nbsp;



<P><TT>If you run it now, you'll get:</TT>

<BR><TT>'<I>Fortran runtime error on external file "C:\xxxxxx\xxxxxx\xxxxxx\input2.tmp"

(1046):</I></TT>

<BR><TT><I>Attempt to open non-existing file with STATUS = OLD</I>'</TT>

<BR><TT>This error message is just due to the fact that the soft doesn't

run without command line arguments (see the batch files in the <I>Script</I>

directory if you plan to use this soft).</TT>

<BR>&nbsp;

<BR>&nbsp;

<BR>&nbsp;



<P>

<HR WIDTH="100%">



<P><B><U><FONT SIZE=+2>S-Tagger for FrameMaker v2.0</FONT></U></B>

<BR><B>-Description:</B>

<BR>Tools for extracting text from MIF files created with Adobe FrameMaker

5.xx.

<BR><B>-OS:</B>

<BR>Win95/NT3.51 (with Service Pack 2 or later installed)/NT 4.0 and Windows

3.x (with Win32s).

<BR><B>-Protection:</B>

<BR>Dongle (parallel ). Driver: <I>ACTIVATOR &amp; UniKey</I> (SSIACT.386

for Win95/3.xx and SSIPDDP.SYS&nbsp; for WinNT).

<BR><B>-Misc.:</B>

<BR>Run in DEMO mode if NO dongle detected (see below).

<BR><TT>&nbsp;</TT>



<P><TT>If no dongle is connected, the program will run in demo mode with

the following limitations:</TT>

<BR><TT>'<I>The demonstration version is a full working version of The

S-Tagger for FrameMaker, with the limitation that only files of a particular

size, up to 180KB for MIF files and 30KB for STF/RTF files, can be processed.</I>'</TT>



<P><TT>Running it will display a message box:</TT>

<BR><TT>'<I>While no dongle is connected to the parallel port, the program

only runs in Demo mode</I>.'</TT>

<BR>&nbsp;

<BR><TT>Disasm the main file (<I>staggerf.exe</I> 650Kb) :</TT>



<P><TT>We can quickly find the '<I>While no dongle</I>...' string data

ref:</TT>



<P><TT>:004047B6 6A01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push 00000001</TT>

<BR><TT>:004047B8 E8A3F6FFFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

call 00403E60&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Check Dongle</FONT></TT>

<BR><TT>:004047BD 85C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

test eax, eax</TT>

<BR><TT>:004047BF 7544&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

jne 00404805&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Good_Guy jump</FONT></TT>

<BR><TT>:004047C1 6A01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push 00000001</TT>

<BR><TT>:004047C3 8D4DC8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

lea ecx, dword ptr [ebp-38]</TT>

<BR><TT>:004047C6 6A05&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push 00000005</TT>

<BR><TT>:004047C8 E893F6FFFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

call 00403E60&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Check Dongle</FONT></TT>

<BR><TT>:004047CD 85C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

test eax, eax</TT>

<BR><TT>:004047CF 7534&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

jne 00404805&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Good_Guy jump</FONT></TT>

<BR><TT>:004047D1 8D4DE4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

lea ecx, dword ptr [ebp-1C]</TT>

<BR><TT>:004047D4 E8237B0400&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

call 0044C2FC</TT>

<BR><TT>:004047D9 68BE000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push 000000BE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; 'While no dongle is connected...'</FONT></TT>



<P><TT>The program check the dongle by calling twice the routine located

at offset :00403E60. I don't know a lot about the Activator dongle, but

it seems to be similar with the Hasp dongle as, each time it calls this

routine, we can see the parameter pushed on the stack push 1, push 5 that

could be 'check_if_dongle_present' and 'type of dongle' but I am not sure.</TT>



<P><TT>When running, S-Tagger displays the <I>About</I> thumbnail where

we can read:</TT>

<BR><TT>'<I>The S-Tagger 2.0 for FrameMaker is running in Demo mode</I>'</TT>

<BR><TT>Searching again in the String data refs, we find 2 locations but

only one is interesting:</TT>



<P><TT>:0042F9FE 687A170000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push 0000177A&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">; '%s is running

in'</FONT></TT>

<BR><TT>...</TT>

<BR><TT>...</TT>

<BR><TT>:0042FA42 6A01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push 00000001</TT>

<BR><TT>:0042FA44 E81744FDFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

call 00403E60</TT>

<BR><TT>:0042FA49 85C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

test eax, eax</TT>

<BR><TT>:0042FA4B 7436&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

je 0042FA83</TT>

<BR><TT>:0042FA4D 6898170000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push 00001798&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">; 'comprehensive

mode.'</FONT></TT>

<BR><TT>...</TT>

<BR><TT>...</TT>

<BR><TT>:0042FAC7 EB21&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

jmp 0042FAEA</TT>



<P><TT>* Referenced by a Jump at Address:0042FA91(C)</TT>

<BR><TT>:0042FAC9 688E170000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push 0000178E&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">; 'demo mode.'</FONT></TT>

<BR><TT>&nbsp;</TT>

<BR><TT>Again, it calls the same routine (:00403E60). We can see that it

will run either in 'demo mode' or in 'comprehensive mode'.</TT>

<BR><TT>Let's have a look at this routine:</TT>



<P><TT>* Referenced by a CALL at Addresses:004047B8, :004047C8, :0040756D,

:0040757D, :00417EF8, :00417F08, :00417F9B, :00417FAB, :0042E6AD, :0042FA44,

:0042FA8A</TT>



<P><TT>:00403E60 807C240474&nbsp;&nbsp; cmp byte ptr [esp+04], 74&nbsp;

<FONT COLOR="#3333FF">; check last 'push xxxxxxxx'</FONT></TT>

<BR><TT>:00403E65 53&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push ebx</TT>

<BR><TT>:00403E66 56&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push esi</TT>

<BR><TT>:00403E67 8BF1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

mov esi, ecx</TT>

<BR><TT>:00403E69 733F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

jnb 00403EAA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; jnb Bad_Guy#2&nbsp;&nbsp; **Change to jmp 00403E89**</FONT></TT>

<BR><TT>:00403E6B 8A5C2410&nbsp;&nbsp;&nbsp;&nbsp; mov bl, byte ptr [esp+10]</TT>

<BR><TT>:00403E6F 80FB01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cmp bl, 01</TT>

<BR><TT>:00403E72 7236&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

jb 00403EAA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; jb Bad_Guy~2</FONT></TT>

<BR><TT>:00403E74 80FB08&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cmp bl, 08</TT>

<BR><TT>:00403E77 7731&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

ja 00403EAA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; ja Bad_Guy#2</FONT></TT>

<BR><TT>:00403E79 E882000000&nbsp;&nbsp; call 00403F00</TT>

<BR><TT>:00403E7E 85C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

test eax, eax</TT>

<BR><TT>:00403E80 7507&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

jne 00403E89&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; jne Good_Guy</FONT></TT>

<BR><TT>:00403E82 33C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

xor eax, eax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Bad_Guy#1</FONT></TT>

<BR><TT>:00403E84 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

pop esi</TT>

<BR><TT>:00403E85 5B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

pop ebx</TT>

<BR><TT>:00403E86 C20800&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ret 0008</TT>



<P><TT>* Referenced by a Jump at Address:00403E80(C)</TT>

<BR><TT>:00403E89 8B44240C&nbsp;&nbsp;&nbsp;&nbsp; mov eax, dword ptr [esp+0C]</TT>

<BR><TT>:00403E8D 8BCE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

mov ecx, esi</TT>

<BR><TT>:00403E8F 50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push eax</TT>

<BR><TT>:00403E90 E88BFFFFFF&nbsp;&nbsp; call 00403E20</TT>

<BR><TT>:00403E95 B201&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

mov dl, 01</TT>

<BR><TT>:00403E97 8D4BFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lea ecx, dword

ptr [ebx-01]</TT>

<BR><TT>:00403E9A D2E2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

shl dl, cl</TT>

<BR><TT>:00403E9C 22D0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

and dl, al</TT>

<BR><TT>:00403E9E 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

pop esi</TT>

<BR><TT>:00403E9F 5B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

pop ebx</TT>

<BR><TT>:00403EA0 80FA01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cmp dl, 01</TT>

<BR><TT>:00403EA3 1BC0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

sbb eax, eax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; eax= -1</FONT></TT>

<BR><TT>:00403EA5 F7D8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

neg eax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; set Good_Guy flag</FONT></TT>

<BR><TT>:00403EA7 C20800&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ret 0008</TT>



<P><TT>* Referenced by a Jump at Addresses:00403E69(C), :00403E72(C), :00403E77(C)</TT>

<BR><TT>:00403EAA 33C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

xor eax, eax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Bad_Guy#2</FONT></TT>

<BR><TT>:00403EAC 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

pop esi</TT>

<BR><TT>:00403EAD 5B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

pop ebx</TT>

<BR><TT>:00403EAE C20800&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ret 0008</TT>



<P><TT>Obviously, patching the <I>jnb Bad_Guy#2</I> is enough to a have

a full working version ('comprehensive mode').</TT>

<BR><TT>There are two calls to offsets :00403F00 and :00403E20. Here is

the code for the first one:</TT>



<P><TT>:00403F00 83EC04&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sub esp, 00000004</TT>

<BR><TT>:00403F03 8D442402&nbsp;&nbsp;&nbsp;&nbsp; lea eax, dword ptr [esp+02]</TT>

<BR><TT>:00403F07 50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push eax</TT>

<BR><TT>:00403F08 E8B3FFFFFF&nbsp;&nbsp; call 00403EC0</TT>

<BR><TT>:00403F0D 85C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

test eax, eax</TT>

<BR><TT>:00403F0F 752B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

jne 00403F3C</TT>

<BR><TT>:00403F11 6A3A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push 0000003A</TT>



<P><TT>* Reference To: W32SSI.wSSIMemR, Ord:0015h</TT>

<BR><TT>:00403F13 E8A8410300&nbsp;&nbsp; Call 004380C0</TT>

<BR><TT>:00403F18 3D6E610000&nbsp;&nbsp; cmp eax, 0000616E</TT>

<BR><TT>:00403F1D 7517&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

jne 00403F36</TT>

<BR><TT>:00403F1F 6A3B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push 0000003B</TT>



<P><TT>* Reference To: W32SSI.wSSIMemR, Ord:0015h</TT>

<BR><TT>:00403F21 E89A410300&nbsp;&nbsp; Call 004380C0</TT>

<BR><TT>:00403F26 3D00210000&nbsp;&nbsp; cmp eax, 00002100</TT>

<BR><TT>:00403F2B 7509&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

jne 00403F36</TT>

<BR><TT>:00403F2D B801000000&nbsp;&nbsp; mov eax, 00000001</TT>

<BR><TT>:00403F32 83C404&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; add esp, 00000004</TT>

<BR><TT>:00403F35 C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

ret</TT>



<P><TT>* Referenced by a Jump at Addresses:00403F1D(C), :00403F2B(C)</TT>

<BR><TT>:00403F36 33C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

xor eax, eax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Bad_Guy</FONT></TT>

<BR><TT>:00403F38 83C404&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; add esp, 00000004</TT>

<BR><TT>:00403F3B C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

ret</TT>



<P><TT>* Referenced by a Jump at Address:00403F0F(C)</TT>

<BR><TT>:00403F3C B801000000&nbsp;&nbsp; mov eax, 00000001</TT>

<BR><TT>:00403F41 83C404&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; add esp, 00000004</TT>

<BR><TT>:00403F44 C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

ret</TT>



<P><TT>Nothing to explain here, everything is clear again: <I>W32ssi.dll</I>

is the DLL that will check for your dongle by calling its driver.</TT>

<BR><TT>I was just wondering if this 'comprehensive mode' was the full

version, so I created a 300Kb MIF file with FrameMaker 5.5 and converted

it with S-Tagger without any problem and the program works well.</TT>

<BR>&nbsp;



<P>

<HR WIDTH="100%">



<P><B><U><FONT SIZE=+2>XinTianMa C</FONT></U></B>

<BR><B>-Description:</B>

<BR>CJK (Chinese-Japanese-Korean) language software for word processing

and viewing of CJK encoded web pages for E-Windows 95/3.1, C-Windows (Traditional

&amp; Simplified), J-Windows and DOS.

<BR><B>-OS:</B>

<BR>Win95/Win3.xx/DOS.

<BR><B>-Protection:</B>

<BR>Dongle (parallel ). Driver: unknown (internal).

<BR><B>-Misc.:</B>

<BR>Does NOT run if no dongle detected.



<P><TT>If you ever get connected to XinTianMa's site, you'll be surprised

to read on top of each page:</TT>

<BR><TT>'<I>This page generated by an evaluation copy of the Microsoft

Merchant Server</I>.'</TT>

<BR><TT>Ohhh, Naughty boys...</TT>



<P><TT>This DOS tool doesn't use any external dongle driver, but its own

one linked inside the main .exe : <I>xtmg.exe</I> 413Kb. Only this file

is protected.</TT>

<BR><TT>Running it will display the following message: '<I>error : XTMG

requires dongle.</I>'</TT>

<BR><TT>&nbsp;</TT>

<BR><TT>&nbsp;Bpio -h 378 and SoftICE pops here:</TT>



<P><TT>00018939: 42&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

inc&nbsp;&nbsp;&nbsp; dx</TT>

<BR><TT>0001893A: 42&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

inc&nbsp;&nbsp;&nbsp; dx</TT>

<BR><TT>0001893B: EC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

in&nbsp;&nbsp;&nbsp;&nbsp; al,dx</TT>

<BR><TT>0001893C: 8AE0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

mov&nbsp;&nbsp;&nbsp; ah,al</TT>

<BR><TT>0001893E: 0C04&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

or&nbsp;&nbsp;&nbsp;&nbsp; al,004</TT>

<BR><TT>00018940: 24BF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

and&nbsp;&nbsp;&nbsp; al,0BF</TT>

<BR><TT>00018942: EE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

out&nbsp;&nbsp;&nbsp; dx,al</TT>

<BR><TT>00018943: 51&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push&nbsp;&nbsp; cx</TT>

<BR><TT>00018944: 8B0E7822&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;

cx,[02278]</TT>

<BR><TT>00018948: E2FE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

loop&nbsp;&nbsp; 000018948</TT>

<BR><TT>0001894A: 59&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

pop&nbsp;&nbsp;&nbsp; cx</TT>

<BR><TT>0001894B: 4A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

dec&nbsp;&nbsp;&nbsp; dx</TT>

<BR><TT>0001894C: 4A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

dec&nbsp;&nbsp;&nbsp; dx</TT>

<BR><TT>0001894D: B0FF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

mov&nbsp;&nbsp;&nbsp; al,0FF</TT>

<BR><TT>0001894F: EE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

out&nbsp;&nbsp;&nbsp; dx,al</TT>

<BR><TT>........</TT>

<BR><TT>There's another similar one located elsewhere in the program. Both

routines are called alternatively. The reason is that the program will

search for 2 different RetCodes.</TT>

<BR>&nbsp;



<P><TT>3 <I>pret</I> later, we land in the middle of this routine:</TT>



<P><TT>00018611: 55&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push&nbsp;&nbsp; bp</TT>

<BR><TT>00018612: 8BEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

mov&nbsp;&nbsp;&nbsp; bp,sp</TT>

<BR><TT>00018614: 57&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push&nbsp;&nbsp; di</TT>

<BR><TT>00018615: 56&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push&nbsp;&nbsp; si</TT>

<BR><TT>00018616: 8B7E06&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;

di,[bp][00006]</TT>

<BR><TT>00018619: C706F040C96E&nbsp; mov&nbsp;&nbsp;&nbsp; w,[040F0],<FONT COLOR="#CC0000">06EC9</FONT>&nbsp;

<FONT COLOR="#3333FF">; Store correct RetCode#1 in [40F0]</FONT></TT>

<BR><TT>0001861F: C706F2404B3F&nbsp; mov&nbsp;&nbsp;&nbsp; w,[040F2],<FONT COLOR="#CC0000">03F4B</FONT>&nbsp;

<FONT COLOR="#3333FF">; Store correct RetCode#2 in [40F2]</FONT></TT>

<BR><TT>00018625: 0BFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

or&nbsp;&nbsp;&nbsp;&nbsp; di,di&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Is it the first time we get here?</FONT></TT>

<BR><TT>00018627: 7512&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

jne&nbsp;&nbsp;&nbsp; 00001863B</TT>

<BR><TT>00018629: 6A29&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push&nbsp;&nbsp; 029</TT>

<BR><TT>0001862B: FF363C22&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;

w,[0223C]</TT>

<BR><TT>0001862F: FF363A22&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;

w,[0223A]</TT>

<BR><TT>00018633: 9A1E001725&nbsp;&nbsp;&nbsp; call&nbsp;&nbsp; 02517:0001E</TT>

<BR><TT>00018638: 83C406&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; add&nbsp;&nbsp;&nbsp;

sp,006</TT>

<BR><TT>0001863B: 2BF6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

sub&nbsp;&nbsp;&nbsp; si,si</TT>

<BR><TT>0001863D: 3BF7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

cmp&nbsp;&nbsp;&nbsp; si,di&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Have both RetCodes been checked and OKayed?</FONT></TT>

<BR><TT>0001863F: 7327&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

jae&nbsp;&nbsp;&nbsp; 000018668&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; jmp to Good_Guy</FONT></TT>

<BR><TT>00018641: 1E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push&nbsp;&nbsp; ds</TT>

<BR><TT>00018642: 683E22&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;

0223E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Prepare welcome message...</FONT></TT>

<BR><TT>00018645: 0E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push&nbsp;&nbsp; cs</TT>

<BR><TT>00018646: E8A7FF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; call&nbsp;&nbsp;

0000185F0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">;

Check // port for dongle</FONT></TT>

<BR><TT>00018649: 5B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

pop&nbsp;&nbsp;&nbsp; bx</TT>

<BR><TT>0001864A: 5B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

pop&nbsp;&nbsp;&nbsp; bx</TT>

<BR><TT>0001864B: 3B06F040&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cmp&nbsp;&nbsp;&nbsp;

ax,[040F0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">;

Check if RetCode#1 OK</FONT></TT>

<BR><TT>0001864F: 7513&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

jne&nbsp;&nbsp;&nbsp; 000018664&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; If not, jump and try again</FONT></TT>

<BR><TT>00018651: 1E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push&nbsp;&nbsp; ds</TT>

<BR><TT>00018652: 685722&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;

02257&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Prepare copyright message...</FONT></TT>

<BR><TT>00018655: 0E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push&nbsp;&nbsp; cs</TT>

<BR><TT>00018656: E897FF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; call&nbsp;&nbsp;

0000185F0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">;

Check // port for dongle</FONT></TT>

<BR><TT>00018659: 5B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

pop&nbsp;&nbsp;&nbsp; bx</TT>

<BR><TT>0001865A: 5B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

pop&nbsp;&nbsp;&nbsp; bx</TT>

<BR><TT>0001865B: 3B06F240&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cmp&nbsp;&nbsp;&nbsp;

ax,[040F2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">;

Check if RetCode#2 OK</FONT>&nbsp;</TT>

<BR><TT>0001865F: 7503&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

jne&nbsp;&nbsp;&nbsp; 000018664&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; If not, jump and try again</FONT></TT>

<BR><TT>00018661: 46&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

inc&nbsp;&nbsp;&nbsp; si&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; inc Check_Dongle counter</FONT></TT>

<BR><TT>00018662: EBD9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

jmps&nbsp;&nbsp; 00001863D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">;

jmp back</FONT></TT>

<BR><TT>00018664: 2BC0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

sub&nbsp;&nbsp;&nbsp; ax,ax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Bad_Guy (clear ax)</FONT></TT>

<BR><TT>00018666: EB03&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

jmps&nbsp;&nbsp; 00001866B</TT>

<BR><TT>00018668: B80100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;

ax,00001&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">;

Set Good_Guy flag</FONT></TT>

<BR><TT>0001866B: 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

pop&nbsp;&nbsp;&nbsp; si</TT>

<BR><TT>0001866C: 5F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

pop&nbsp;&nbsp;&nbsp; di</TT>

<BR><TT>0001866D: C9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

leave</TT>

<BR><TT>0001866E: CB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

retf&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Back to caller</FONT></TT>



<P><TT>0001866F: 55&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push&nbsp;&nbsp; bp</TT>

<BR><TT>00018670: 8BEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

mov&nbsp;&nbsp;&nbsp; bp,sp</TT>

<BR><TT>00018672: 56&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push&nbsp;&nbsp; si</TT>

<BR><TT>00018673: BE0100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;

si,00001</TT>

<BR><TT>00018676: 83FE04&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cmp&nbsp;&nbsp;&nbsp;

si,004&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Check_Dongle counter =&lt;4 ?</FONT></TT>

<BR><TT>00018679: 7720&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

ja&nbsp;&nbsp;&nbsp;&nbsp; 00001869B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; jmp to Bag_Guy if >=5</FONT></TT>

<BR><TT>0001867B: 56&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push&nbsp;&nbsp; si</TT>

<BR><TT>0001867C: 9A1B003215&nbsp;&nbsp; call&nbsp;&nbsp; 01532:0001B -</TT>

<BR><TT>00018681: 5B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

pop&nbsp;&nbsp;&nbsp; bx</TT>

<BR><TT>00018682: 0BC0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

or&nbsp;&nbsp;&nbsp;&nbsp; ax,ax</TT>

<BR><TT>00018684: 740C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

je&nbsp;&nbsp;&nbsp;&nbsp; 000018692&nbsp;&nbsp; -</TT>

<BR><TT>00018686: FF7606&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;

w,[bp][00006]</TT>

<BR><TT>00018689: 0E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push&nbsp;&nbsp; cs</TT>

<BR><TT>0001868A: E884FF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; call&nbsp;&nbsp;

000018611&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">;

Call previous routine</FONT></TT>

<BR><TT>0001868D: 5B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

pop&nbsp;&nbsp;&nbsp; bx</TT>

<BR><TT>0001868E: 0BC0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

or&nbsp;&nbsp;&nbsp;&nbsp; ax,ax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Is it OK?</FONT></TT>

<BR><TT>00018690: 7503&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

jne&nbsp;&nbsp;&nbsp; 000018695&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; jmp Good_Guy</FONT></TT>

<BR><TT>00018692: 46&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

inc&nbsp;&nbsp;&nbsp; si&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; inc Check_Dongle counter</FONT></TT>

<BR><TT>00018693: EBE1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

jmps&nbsp;&nbsp; 000018676&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; jmp back</FONT> <FONT COLOR="#3333FF">and try your

luck again.</FONT></TT>

<BR><TT>00018695: B80100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;

ax,00001&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">;

Set Good_Guy flag...</FONT></TT>

<BR><TT>00018698: 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

pop&nbsp;&nbsp;&nbsp; si</TT>

<BR><TT>00018699: C9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

leave</TT>

<BR><TT>0001869A: CB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

retf</TT>

<BR><TT>0001869B: 2BC0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

sub&nbsp;&nbsp;&nbsp; ax,ax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Bad_Guy flag</FONT></TT>

<BR><TT>0001869D: 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

pop&nbsp;&nbsp;&nbsp; si</TT>

<BR><TT>0001869E: C9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

leave</TT>

<BR><TT>0001869F: CB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

retf</TT>

<BR><TT>...</TT>

<BR><TT>000186F8: E874FF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; call&nbsp;&nbsp;

00001866F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">;

Call the above routine</FONT></TT>

<BR><TT>000186FB: 5B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

pop&nbsp;&nbsp;&nbsp; bx</TT>

<BR><TT>000186FC: 0BC0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

or&nbsp;&nbsp;&nbsp;&nbsp; ax,ax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Dongle or no dongle ?</FONT></TT>

<BR><TT>000186FE: 7521&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

jne&nbsp;&nbsp;&nbsp; 000018721</TT>

<BR><TT>...</TT>

<BR><TT>00018721: B80100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;

ax,00001&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">;

found it, go ahead</FONT></TT>

<BR><TT>00018724: CB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

retf</TT>

<BR><TT>0001869B: 2BC0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

sub&nbsp;&nbsp;&nbsp; ax,ax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; otherwise clear ax and exit</FONT></TT>

<BR><TT>0001869D: 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

pop&nbsp;&nbsp;&nbsp; si</TT>

<BR><TT>0001869E: C9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

leave</TT>

<BR><TT>0001869F: CB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

retf</TT>

<BR><TT>&nbsp;</TT>

<BR><TT>The program check the RetCode#1 and, if it is not correct, will

check it again 3 times. After that, if it is still the wrong RetCode you

are sent away otherwise it will do the same job for the RetCode#2.</TT>

<BR><TT>The stupid part of this code is when the program stores the 2 correct

RetCodes, and the fact that everything is located in same area. Hard to

miss it!</TT>

<BR><TT>As there are at least one dozen different ways to patch and crack

this, I let you decide which one you prefer, there's no need to explain

this.</TT>



<P>

<HR WIDTH="100%">



<P><A NAME="OmniMark"></A><B><U><FONT SIZE=+2>OmniMark v3R1a Win95</FONT></U></B>

<BR><B>-Description:</B>

<BR>Perform large-scale conversion and mark-up of text and data for delivery

in print or on CD-ROM, as well as allow Intranet and website builders to

automate the presentation of individualized content

<BR><B>-OS:</B>

<BR>Win95 (there are other versions for DOS/Win3.XX, NT, OS/2).

<BR><B>-Protection:</B>

<BR>Dongle (parallel ). Driver: <I>Hasp95.vxd</I>.

<BR><B>-Misc.:</B>

<BR>Does NOT run if no dongle detected.



<P><TT>This 32bit app will run in a DOS box. I tried it and it appears

to be fast and very efficient.</TT>



<P><TT>That's another Hasp dongle! Let's bash it too.</TT>

<BR><TT>With Hiew, we can quickly locate the main hasp routine in the main

executable (<I>omnimark.exe</I> 1.5Mb): 00133548 (:00533548 with SoftICE

or W32Dasm).</TT>

<BR><TT>Running the program will display:</TT>

<BR><TT>'<I>Authorization failed. Exiting OmniMark.</I>'</TT>



<P><TT>Though it's just another stupid protection, I add it here for 2

reasons:</TT>

<BR><TT>1) though I cracked several Hasp protected softs, this is the first

one I found that will clear eax for the Good_Guy and set it to 1 for the

Bad_Guy:</TT>



<P><TT>:0041104A 6A01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push 00000001</TT>

<BR><TT>:0041104C E8F7241200&nbsp;&nbsp;&nbsp; call 00533548&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Call Hasp Service#1</FONT></TT>

<BR><TT>:00411051 83C424&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; add

esp, 00000024</TT>

<BR><TT>:00411054 837DFC00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cmp dword ptr

[ebp-04], 00000000 <FONT COLOR="#3333FF">; Is it a Hasp (RetCode#1 should

be =0x01)</FONT></TT>

<BR><TT>:00411058 0F850A000000&nbsp; jne 00411068&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Good_Guy jump</FONT></TT>

<BR><TT>:0041105E B801000000&nbsp;&nbsp;&nbsp; mov eax, 00000001&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Set Bad_Guy_Flag</FONT></TT>

<BR><TT>:00411063 E9A6020000&nbsp;&nbsp;&nbsp; jmp 0041130E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; terminate</FONT></TT>

<BR><TT>The first time I ran it, I just put a BPX on the main Hasp routine,

get back to the caller and make it jump (as usual) until the <I>mov eax,1</I>

at the end of this routine and.. got this 'Authorization failed' message.</TT>



<P><TT>2) one tip, that works sometimes, is to search for some ofently

used instructions like the <I>Jmp Next_Instruction</I> (0xe90000000)located

at the end of the main routine that will call the dongle routine. It is

useless and only used instead of 5 <I>nop</I>:</TT>



<P><TT>:00410BD1 E8AA030000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

call 00410F80</TT>

<BR><TT>:00410BD6 83C404&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

add esp, 00000004</TT>

<BR><TT>:00410BD9 <FONT COLOR="#CC0000">E900000000</FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

jmp 00410BDE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; useless</FONT></TT>

<BR><TT>:00410BDE 5F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

pop edi</TT>

<BR><TT>:00410BDF 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

pop esi</TT>

<BR><TT>:00410BE0 5B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

pop ebx</TT>

<BR><TT>:00410BE1 C9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

leave</TT>

<BR><TT>:00410BE2 C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

ret</TT>

<BR><TT>...</TT>

<BR><TT>...</TT>

<BR><TT>:004112EA 85C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

test eax, eax</TT>

<BR><TT>:004112EC 0F8412000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

je 00411304</TT>

<BR><TT>:004112F2 8B45E0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

mov eax, dword ptr [ebp-20]</TT>

<BR><TT>:004112F5 A34C2C5600&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

mov dword ptr [00562C4C], eax</TT>

<BR><TT>:004112FA C7059C3E56009A1F4100&nbsp;&nbsp;&nbsp; mov dword ptr

[00563E9C], 00411F9A</TT>

<BR><TT>:00411304 B801000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

mov eax, 00000001</TT>

<BR><TT>:00411309 <FONT COLOR="#CC0000">E900000000</FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

jmp 0041130E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; useless</FONT></TT>

<BR><TT>:0041130E 5F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

pop edi</TT>

<BR><TT>:0041130F 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

pop esi</TT>

<BR><TT>:00411310 5B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

pop ebx</TT>

<BR><TT>:00411311 C9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

leave</TT>

<BR><TT>:00411312 C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

ret</TT>

<BR>&nbsp;

<BR>&nbsp;

<BR>&nbsp;



<P><TT>Well, that's all to say about this soft, because if you disasm it

and have a look in the String data refs, you'll get:</TT>



<P><TT>:004018ED E828F30000&nbsp;&nbsp;&nbsp; call 00410C1A</TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<TT><FONT COLOR="#3333FF">; Check dongle</FONT></TT>

<BR><TT>:004018F2 85C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

test eax, eax</TT>

<BR><TT>:004018F4 0F8512000000&nbsp; jne 0040190C</TT>

<BR><TT>:004018FA 687C115400&nbsp;&nbsp;&nbsp; push 0054117C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; 'Authorization failed. Exiting OmniMark'.</FONT></TT>

<BR><TT>:004018FF E894F20000&nbsp;&nbsp;&nbsp; call 00410B98</TT>

<BR><TT>:00401904 83C404&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; add

esp, 00000004</TT>

<BR><TT>:00401907 E864F20000&nbsp;&nbsp;&nbsp; call 00410B70</TT>

<BR><TT>:0040190C E92F000000&nbsp;&nbsp;&nbsp; jmp 00401940</TT>



<P><TT>No comments here as well about how to crack it...</TT>

<BR>&nbsp;



<P>

<HR WIDTH="100%">

<BR>

<HR WIDTH="100%">

<BR>&nbsp;



<P><TT>And now, just for the fun, as I started my essay with Aladdin informations

and tips about 'how_to_protect_better_your_soft_with_our_state_of_the_art_dongle',

I though it may be worth having a quick look at one of the free tools you

can get on their site: <I>Haptest.exe</I></TT>

<BR><TT>Description:</TT>

<BR><I><TT>'Hasptest is a simple program that checks the existency of FotoWare

protection dongles. It will report the different dongles found on your

system. This can be used to check that all dongles are found, and that

they are working properly.'</TT></I>

<BR>&nbsp;



<P><TT>Here is just one piece of code from this 60Kb .exe file (all other

calls to the dongle are strictly similar):</TT>



<P><TT>:00401BD6 6A02&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push 00000002</TT>

<BR><TT>:00401BD8 E823F4FFFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

call 00401000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Hasp routine service #2</FONT></TT>

<BR><TT>:00401BDD 83C424&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

add esp, 00000024</TT>

<BR><TT>:00401BE0 817C240867B80000&nbsp; cmp dword ptr [esp+08], 0000B867&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Is RetCode1=0xB867 ?</FONT></TT>

<BR><TT>:00401BE8 752C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

jne 00401C16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Bad_Guy_Jump</FONT></TT>

<BR><TT>:00401BEA 817C240C964D0000&nbsp; cmp dword ptr [esp+0C], 00004D96&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Is RetCode2=0x4D96 ?</FONT></TT>

<BR><TT>:00401BF2 7522&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

jne 00401C16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Bad_Guy_Jump</FONT></TT>

<BR><TT>:00401BF4 817C241098BD0000&nbsp; cmp dword ptr [esp+10], 0000BD98&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Is RetCode3=0xBD98 ?</FONT></TT>

<BR><TT>:00401BFC 7518&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

jne 00401C16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Bad_Guy_Jump</FONT></TT>

<BR><TT>:00401BFE 817C2414366A0000&nbsp; cmp dword ptr [esp+14], 00006A36&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Is RetCode4=0x6A36 ?</FONT></TT>

<BR><TT>:00401C06 750E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

jne 00401C16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Bad_Guy_Jump</FONT></TT>

<BR><TT>:00401C08 6A40&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push 00000040&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; Good_Guy</FONT></TT>

<BR><TT>:00401C0A 6838514000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push 00405138&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; 'HASP TEST'</FONT></TT>

<BR><TT>:00401C0F 68C0504000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push 004050C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; 'FotoSync CSF HASP found'</FONT></TT>

<BR><TT>:00401C14 EB0C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

jmp 00401C22</TT>

<BR><TT>:00401C16 6A10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push 00000010&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; 'HASP TEST'</FONT></TT>

<BR><TT>:00401C18 6838514000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push 00405138&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#3333FF">; '** NO FotoSync CSF HASP found **'</FONT></TT>

<BR><TT>...</TT>

<BR><TT>...</TT>

<BR><TT>Well, since they advise programmers to better protect their softs,

I thought they might have taken this opportunity to do the same with their

own programs...</TT>

<BR>&nbsp;



<P><TT>That's all.</TT>

<BR><TT>If I don't get a 'Dongle overdose' within the next few hours, and

if I am smart enough, I may go and try to fetch all free dongle softs available

on the Net, put them in a list and mail it to +Fravia for the +HCU.</TT>

<BR>&nbsp;

<HR><CENTER><I>OK, he did it: <A href="donglink.htm" tppabs="http://www.anticrack.de/fravia/donglink.htm">here it is</A></I></CENTER><HR>





<P><TT>Frog's Print - January 29, 1998</TT>





<!-- OB DUH STARTS HERE -->

<BR><BR>

<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" HEIGHT="45"  WIDTH= "100%">

<TR><TD bgcolor="#C6E7C6"><CENTER><FONT size=+2><FONT color=blue>Ob Duh</FONT></FONT></CENTER><BR>

</TD></TR></TABLE>

 <CENTER>

   <I>I wont even bother explaining you 

   that you should BUY the relevant target programs if you intend to use them 

 for non-study purposes. Should you want 

   to STEAL this software instead, you don't need to crack its protection 

   scheme at all: you'll 

   find it on most Warez sites, complete and already regged, farewell.</I>

</CENTER>



<!-- WAY OUT STARTS HERE -->

<HR>

<CENTER><I>You are deep inside fravia's page of reverse engineering,  

choose your way out:</I></CENTER>

<BR><CENTER>

<!-- EITHER A NICE GIF -->





<A href="advanced.htm" tppabs="http://www.anticrack.de/fravia/advanced.htm"><IMG SRC="xtranio.gif" tppabs="http://www.anticrack.de/fravia/xtranio.gif" 

ALT="advanced" ALIGN=CENTER WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></A>

<BR>



<FONT color=gray>Back to advanced cracking</FONT><BR>

<BR>







<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="index.html" tppabs="http://www.anticrack.de/fravia/index.html">homepage</A>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="links.htm" tppabs="http://www.anticrack.de/fravia/links.htm">links</A> 

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="noanon.htm" tppabs="http://www.anticrack.de/fravia/noanon.htm">anonymity</A> 

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALIGN=BOTTOM

BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"><A HREF="orc.htm" tppabs="http://www.anticrack.de/fravia/orc.htm">+ORC</A>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="student.htm" tppabs="http://www.anticrack.de/fravia/student.htm">students' essays</A>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="academy.htm" tppabs="http://www.anticrack.de/fravia/academy.htm">academy database</A>

<BR>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="tools.htm" tppabs="http://www.anticrack.de/fravia/tools.htm">tools</A>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="javascri.htm" tppabs="http://www.anticrack.de/fravia/javascri.htm">javascript wars</A>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="cocktail.htm" tppabs="http://www.anticrack.de/fravia/cocktail.htm">cocktails</A>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="ideale.htm" tppabs="http://www.anticrack.de/fravia/ideale.htm">antismut CGI-scripts</A>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="searengi.htm" tppabs="http://www.anticrack.de/fravia/searengi.htm">search_forms</A>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="info.htm" tppabs="http://www.anticrack.de/fravia/info.htm">mail_fravia+</A>

<BR>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="legal.htm" tppabs="http://www.anticrack.de/fravia/legal.htm">Is reverse engineering legal?</A>

</CENTER>

<HR>



</BODY>

</HTML>