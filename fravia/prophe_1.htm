<HTML>

<HEAD>

<!--  formamus.htm version 02 February 1998 

      INSTRUCTIONS FOR SUBMITTING: DO NOT USE HTML EDITORS!

      SEARCH THIS TEXT FOR THE STRING "Your_" 

      AND REPLACE WITH WHATEVER YOU WANT TO PUBLISH! 

      THANKS A LOT: this will allow automated retrieval -->

<TITLE>prophe_1.htm An introduction to code generation routines: reversing Teleport Pro v1.29</TITLE>

</HEAD>



<BODY BGCOLOR=#C0C0C0 TEXT=#001010 VLINK=#405040>

<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%  HEIGHT=" 22">

<TR><td></td>

<td>

<!-- Choose  a TITLE probably wont be changed -->

<center><FONT SIZE="+2">An introduction to code generation routines: reversing Teleport Pro v1.29</fonT><br>

        <FONT SIZE="+1">The last beginners approach on fravia's site</fonT>

</center>

</td>



<td>

<!-- Choose  a PROJECT GIF, leave this if unsure -->

<center><a href="student.htm#student_loo_na" tppabs="http://www.anticrack.de/fravia/student.htm#student_loo_na"><IMG SRC="notassi3.gif" tppabs="http://www.anticrack.de/fravia/notassi3.gif" ALT="student" 

ALIGN=CENTER WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 

HSPACE=0></a>

<br>

<font color=gray>Not Assigned</FonT>

</center></td></tr>

<tR>

<td bgcolor="#FFFFEA"><center>

<FONT COLOR="890000">

<!-- CHOOSE A DATE (will probably be changed) -->

14th May 1998

</FONT></center>

</td>

<td bgcolor="#FFFFEA"><center>by <font size=+3>

<!-- CHOOSE A HANDLE (wont be changed) -->

Prophecy

</fonT></center>

</td>

<td VALIGN="center" bgcolor="#FFFFEA">

<!--

<a href="hcu98_3.htm" tppabs="http://www.anticrack.de/fravia/hcu98_3.htm"><IMG SRC="hcu1.gif" tppabs="http://www.anticrack.de/fravia/hcu1.gif" ALT="+cracker" ALIGN=BOTTOM 

WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a>

-->

</td>

</tr>

<TR><td><center><a href="index.html" tppabs="http://www.anticrack.de/fravia/index.html"><IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALIGN="BOTTOM" 

BORDER="0" VSPACE="0" HSPACE="0" width="13" height="13"></a></center></td>

<TD BGCOLOR="898030"><center>Courtesy of Fravia's page of 

reverse engineering</center> 

</center></TD>

<td BGCOLOR="898030">

<center>

<!-- Your truly+ will edit only if really necessary -->

slightly edited<br>

by fravia+</center></td>

</TR>

<!-- this is for the data.....fra_00xx....yymmdd....handle..beg+int...not ass... -->

<tr><td><font color="#C4C0CF">fra_00xx<bR>98xxxx<br>handle<br>1100<br>NA<br>PC<br></fonT></td><td><i><center>

<!-- Your truly+ comments -->

Prophecy thought this as a "beginner" essay, which is true... it is nevertheless a good

essay. Yet this is THE LAST beginner essay I will ever publish on my site (unless the

techniques change radically, which I doubt :-). Yes, I will not publish any "beginner"

essays anymore. In fact I believe there is now enough material on my (and some other)

pages to help anyone to grow from beginner to intermediate... if the reader has at

least a little will, that is. Beginners have had enough. Basta, finito, pass over to the

next stage: it's about time to draw a line IMO (correct me if you reckon I'm wrong).

This essay is definitely NOT an "useless" beginner essay btw, it's an interesting article

for any beginner reversers ans protectors alike... and don't snarl at beginners (I can't

stand snotty 'elite' crackers the beginners of today are the masters of tomorrow (yet

I'm decided... I won't publish any "beginners" essay any more :-) Enjoy Prophecy's

good work!

</i></center></td>

<td></td>

</tr>

<TR><td></td>

<!-- Leonard Coehn's old song, because we are poets, not only crackers -->

<TD BGCOLOR="898030"><center></i><b>There is a crack, a crack in everything 

That's how the light gets in</b></center>

<!-- Leonard Coehn's old song, because we are poets, not only crackers -->

</center></TD><td></td>

</TR>

<TR>

<td VALIGN= "MIDDLE" bgcolor="#C6E7C6"><font color=blue><center>

Rating</FONT></FONT></center>

</TD>

<td VALIGN = "MIDDLE" bgcolor="#C6E7C6"><font color=blue><center>

<!-- CHOOSE A RATING (may be changed) -->

(x)<B>Beginner</B> ( )<B>Intermediate</B> ( )<B>Advanced</B> ( )<B>Expert</B></FONT>

</center></td>

<td></td>

</tr>

</table>

<!-- END HEAD  -->

<bR>

<!-- CORPUS  -->



<!-- CHOOSE A COMMENT (may be changed)  -->

<PRE>

This essay illustrates how a simple code generation routine based upon the

user's name works, and describes a clear approach to reversing this target.

Many of the techniques described in this essay can be used to reverse other

targets... this essay was written by a beginner, for beginners.

</PRE>

<hR>

<center>

   <FONT SIZE="+2">

<!-- CHOOSE A TITLE (wont probably be changed) -->

An introduction to code generation routines: reversing Teleport Pro v1.29

   </FONT><BR>

   <FONT SIZE="+2">

<!-- CHOOSE A SUBTITLE (wont proabbly be changed) -->

The last beginners approach on fravia's site

   </FONT><BR>

   <FONT COLOR="0B7FC1">

<!-- REPEAT YOUR CHOSEN HANDLE HERE -->Written by 

Prophecy

   </FONT>

</center><br><br>



<!-- INTRO STARTS HERE -->

<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >

<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Introduction</fonT>

</fonT></center></td></tr></table>

<pre>

<B><FONT  SIZE=+1>Table of contents:</FONT></B> <I>(use this once you've already read through the essay and you

only want to reference specific sections)</I>



<A HREF="#introduction">Introduction...</A>

<A HREF="#target">About the target...</A>

<A HREF="#tools">Tools required...</A>

<A HREF="#target'surl">Target's URL...</A>

<A HREF="#letsgetstarted">Let's get started...</A>

<A HREF="#softice">Setting up SoftIce...</A>

<A HREF="#skipsoftice">The main body of the essay...</A>

<A HREF="#startofkeygen">The C source code for the key generator...</A>

<A HREF="#credits">Credits...</A>

<A HREF="#finalwords">Final words...</A>



Note:  I can be contacted at:  <A HREF="mailto:prophecy_@usa.net">prophecy_@usa.net</A>



<B><FONT  SIZE=+1><A NAME="introduction">Introduction:</A></FONT></B>



<I>This essay is dedicated to fravia, the #cracking4newbies crew, and to those

who have contributed to fravia's academy...</I>	



I am very grateful to all the people who have written essays, and shared their

knowledge of cracking with everyone else.  Now that I've gained a bit of

experience, I feel that I am now ready to contribute a small something back

to the cracking community.



The contents of this essay is aimed at beginners, and you shouldn't have much

trouble following it, just don't go too fast, and make sure you read everything!



I'm going to show you how the target generates the serial numbers so that you

can work out a serial number for your name and so that you can make a key

generator.  What I hate about a lot of essays is the cracker who writes them

assumes you know the same amount as him/her, leaving beginners like me and you

confused and annoyed.  Throughout this essay, I have explained everything to

the best of my ability (remember I'm only a beginner too and I can't explain

everything).



<FONT  SIZE=+1><B><A NAME="target">Target:</A></A></B></FONT>



We are going to reverse Teleport Pro 1.29 (Build 622).  This is a nice app which

lets you download entire web pages like the entire academy at fravia.org etc...

the shareware version, however, is crippled because it only lets you download

up to 500 threads, hence our need to crack it.

</prE>

<br><br>



<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >

<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue><A NAME="tools">Tools required</A></fonT>

</fonT></center></td></tr></table>

<PRE>

Numega SoftIce (I use v3.22)

C compiler if you want to modify my source code to make your own key generators

</PRE>

<br><br>



<!-- TARGET URL STARTS HERE -->

<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >

<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue><A NAME="target'surl">Target's URL</A>/FTP</fonT>

</fonT></center></td></tr></table>

<!-- DON'T FORGET TO PASTE HERE THE URL/FTP OF YOUR TARGET(S) -->

<PRE>

You can obtain the target from:  <A HREF="javascript:if(confirm('http://www.tenmax.com/pro.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.tenmax.com/pro.html'" tppabs="http://www.tenmax.com/pro.html">http://www.tenmax.com/pro.html</A> OR

<A HREF="javascript:if(confirm('http://www.winfiles.com/apps/98/offline.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.winfiles.com/apps/98/offline.html'" tppabs="http://www.winfiles.com/apps/98/offline.html">http://www.winfiles.com/apps/98/offline.html</A>.

</PRE>

<br><br>



<!-- PROGRAM HISTORY STARTS HERE -->

<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >

<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Program History</fonT>

</fonT></center></td></tr></table>

<!-- PASTE HERE YOUR TARGET'S HISTORY (if any) -->

<pre>

History is not relevent here.

</pre>

<br><br>



<!-- REAL ESSAY  STARTS HERE -->

<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >

<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Essay</fonT></fonT>

</center></td></tr></table>

<!-- PASTE HERE THE TEXT OF YOUR ESSAY

     THIS IS OF COURSE THE MOST IMPORTANT PART

     PLEASE CHECK THE MARGINS WHEN YOU ARE FINISHED! 

     SHOULD NOT BLAST NETSCAPE MARGINS OUT! HAVE A LOOK INSIDE

     YOUR OWN BROWSER WHEN YOU HAVE FINISHED!  -->

<pre>

<B><FONT  SIZE=+1>Okay!  <A NAME="letsgetstarted">Let's get started</A> by having a look round the target...:</FONT></B>



Before rushing headfirst into SoftIce, let's have a little look round the

target.  First of all, load it up and click on Help.  Ahh, a 'register...'

option... let's check it out.  Looks like a pretty standard name and serial

number protection.  Okey, let's investigate: click on the 'Mail/Email/Fax'

button.  First, you'll notice the company field is optional, so we can assume

that the target doesn't use that field to generate the serial number, and we can

leave that field blank.  Ok, now click on 'Save to Disk' button... what does it

say?  It says "Please enter a name because we need it to generate your serial

number!" (suprise, surprise).  Ok, enter a small name like bob, and click 'Save

to Disk'.. what does it say now?  "Our name is too short".. hmm okay, we soon

determine that the minimum length name is 5 letters long.  So our snooping has

led us to these conclusions: our name must be at least 5 letters long and is

used to generate the code, and we can leave the company field blank.<BR><BR>



<B><FONT  SIZE=+1><A NAME="softice">Setting up SoftIce...:</A></FONT></B>



Okey, if your SoftIce is already sweetly set up, you can <A HREF="#skipsoftice">skip</A> this section.

When SoftIce loads with it's default values, it is in a sorry state, you

only get 25 lines of code, the Registers window isn't there, and a whole lot of

other stuff is missing too...to remedy this, I suggest you use my settings.  To

use my settings open up the winice.dat file in the SoftIce directory.  You

should see (round about line 20) INIT="X;".  Replace that with the two INIT

lines below... if you have INIT="a whole lot of stuff like above" then chances

are it's already ok, and you don't have to replace them.  You'll need to restart

your computer for the changes to take effect.



  INIT="lines 60;code on;wd 13;wc 25;wr;ww 6;wl;dex 1 ss:esp;faults off;"

  INIT="altkey ctrl d;watch es:di;watch eax;watch *es:di;set mouse 3;cls;X;"



So what does all this stuff do you ask? Here's a quick rundown:



  lines 60 - sets SoftIce to use 60 lines

  code on - displays the hexidecimal byte code next to the disassembled

            listing

  wd 13 - enables the data window and sets it to 13 lines

  wc 25 - enables the code window and sets it to 25 lines

  ww 6 - enables the watches window and sets it to 6 lines

  watch bla - displays the value of bla in the watch window

  set mouse 3 - puts mouse speed on full (yeeehaaaa)

  cls - clears the screen

  faults off - means when your computer crashes, SoftIce doesn't kick in (you

               don't want faults ON because when SoftIce pops up because of a

               fault it won't let you out again)

  altkey ctrl d - this is the default value for switching to softice - set it

                  to whatever you want

  dex 1 ss:esp - not quite sure :)



Note:  sometimes, when you switch from SoftIce back to Windows95 it crashes, and

displays a whole bunch of vertical lines on your monitor... this is probably due

to incompatibility with your video card and can be fixed by running SoftIce in a

window.  Tu run SoftIce in a window, go to the the SoftIce from the startup menu

and click 'Display Adapter Setup', then check the 'Universal driver' box.  You

can then configure (in SoftIce) the number of lines by typing lines x, where x

ranges from 25-128 and width y, where y ranges from 80-160.  You can set the 

font by typing set font n, where n = 1, 2 or 3.  If you use SoftIce in a window,

you should modify the winice.dat INIT lines with the new settings... (see the

readme.txt file in the \softice directory for more details).



One more thing that's important, is that you need to export the functions from

the standard windows functions, otherwise you won't be able to breakpoint on

anything.  To make sure the functions of these libraries are exported to

softice, load up the winice.dat file and go down near the bottom of the file

until you see ;*** Examples of export symbols that can be included for Windows

95 ***.  Okey, now remove the semi-colon from in front of the the kernel32.dll

and user32.dll export statements, and make sure the path points to the right

windows system directory.  Now, you'll have most of the main functions available

to you, another good one to export is advapi.dll.



Okey, let's test our SoftIce setup.. hit Ctrl-D, you should see (rough sketch):



+------------------------------------------------------------------------------+

| EAX=...     This is the registers window, activate it                        |

| EDI=...     by typing <B>wr</B>                                                     |

+------------------------------------------------------------------------------+

| es:di=...   This is the watch window, activate it by typing <B>ww</B>.  To watch    |

|             something, type watch bla, eg <B>watch eax</B>                          |

+------------------------------------------------------------------------------+

| <FONT  COLOR=#357735>xxxx:yyyyyyyy 01 02 03 04 05 06 07 08-09 10 11 12 13 14 15 16 ...............</FONT>|

| <FONT  COLOR=#357735>xxxx:yyyyyyyy 01 02 03 04 05 06 07 08-09 10 11 12 13 14 15 16 ...............</FONT>|

|                                                                              |

| This is the data window, activate it by typing <B>wd</B>.  It is here that you can  |

| see what's stored in memory.                                                 |

+------------------------------------------------------------------------------+

| <FONT  COLOR=#0000FF>0028:C000A010  7902                JNS     C000A014                  (JUMP  )</FONT>|

| <FONT  COLOR=#0000FF>0028:C000A012  33C0                XOR     EAX,EAX</FONT>                           |

| <FONT  COLOR=#0000FF>0028:C000A014  83E81F              SUB     EAX,1F</FONT>                            |

|                                                                              |

| This is the code window, where the assembly commands the target is executing |

| are displayed.  Activate this window by typing <B>wc</B>.                           |

+------------------------------------------------------------------------------+

|:< type your commands here >                                                  |

|                                                                              |

| Well this is where you type your commands, simple huh?                       |

+------------------------------------------------------------------------------+



(I got a lot of this information from Mammon_'s excellent SoftIce tutorial,

which is availabe at <A HREF="index.htm" tppabs="http://www.anticrack.de/fravia/index.htm">http://fravia.org</A>).



Anyway, now we're ready to rock'n'roll!



<B><A NAME="skipsoftice"><FONT  SIZE=+1>Let's break into SoftIce and see what happens...:</FONT></A></B>



<I>(Some crackers would prefer to 'dead list' the target first using w32dasm but

I'm rash, and want to get straight to the action.  If I fail with SoftIce, then

I have a look round with w32dasm, but I always prefer the more eloquent solution

of a valid serial number rather than a patch that changes '74' to '75'.)</I>



We want to work out how the target generates the serial number right?  And we

know there's a good chance that our name is going to be used in the process

(unless the author is lying).  It should be noted that finding the serial number

for the name you entered isn't too hard (it only took me 5 hours hehe), but

we're not interested in that, we want to get to the bottom of the code

generating routine and see how this target really works, then we can write a key

generator, and our curiousity will be appeased and the world will live happily

ever after.



Okey then, let's enter a name in the Name box, eg Prophecy, and a bogus code,

eg 666777888.  Now we need to set a breakpoint in SoftIce so that we pop into

SoftIce at a point close to where the target is going to generate the code and

compare it to our bogus code.  Okay, let's pop into SoftIce (Ctrl-D or whatever)

and set a breakpoint: <B>BPX getwindowtexta</B>.  This means SoftIce will pop up

on execution of the getwindowtexta command, which is a common command a target

uses to read info supplied by a user (eg name and (bogus) serial number).  Okey,

hit < F5 > to go back to the target and click OK.  Bang! we're in SoftIce.

Press < F11 > to trace the call back to the target.



Now, have a careful look at the registers...:



EAX=8 (this is the length of our name)



Hrmm, so there's not much going on round here.  Let's find our name in memory:

type <B>s 0 l ffffffff "Prophecy"</B>.  Right, you should see your name in the data

window like so:



<FONT  COLOR=#357735>013F:00FB266C  50 72 6f 70 68 65 63 79-00 00 00 00 00 00 00 00  Prophecy........</FONT>

^^^^^^^^^^^^^

(these numbers will probably be different to yours)



So the address of my name is <B>fb266c</B>.



(there may be more than one instance of your name in memory, typing <B>s</B> will

display the next match in memory.  If you are having trouble finding your name,

try typing a name that you KNOW won't be in memory eg PrinceCharles, then repeat

the search process).



Okey, now we want SoftIce to break whenever the target accesses the memory

containing your name, to do this, we must use the bpr (break when a range of

memory is accessed) command by typing: <B>bpr fb266c fb266c+8 rw</B>.  Since we're

interested in seeing how the target manipulates our name to generate the serial

number, we no longer need the the breakpoint on getwindowtexta.  To get rid of

it type <B>bc 0</B>.  Now let's continue and see what happens to our name... press

< f5 > and you should see this:



(<I>Note that throughout the assembly listing, comments that begin with '?' are

ones I'm not sure about, but which I think are a possibility).</I>



<FONT  COLOR=#0000FF>0137:BFF7117E  F2AE                REPNZ SCASB</FONT> ;?finds length of your name

<FONT  COLOR=#0000FF>0137:BFF71180  83C8FE              OR      EAX,-02</FONT> ;?

<FONT  COLOR=#0000FF>0137:BFF71183  2BC1                SUB     EAX,ECX</FONT> ;eax=eax-ecx

<FONT  COLOR=#0000FF>0137:BFF71185  5F                  POP     EDI</FONT> ;pops edi from the stack

<FONT  COLOR=#0000FF>0137:BFF71186  59                  POP     ECX</FONT> ;pops ecx from the stack

<FONT  COLOR=#0000FF>0137:BFF71187  C9                  LEAVE</FONT> ;let's leave this call



Okey, a bit of 'zen' (intuition) tells me that this part of the code isn't very

interesting (how do I do suspect it isn't interesting?  Well, after looking at

lots of lines of code, you can begin to 'feel' the code, and draw accurate

assumptions from it- you will be able to as well, just go through lots of

essays and tutorials).  So lets move on:  press < f10 > to step past the <FONT  COLOR=#0000FF>REPNZ

SCASB</FONT> line until the <FONT  COLOR=#0000FF>OR EAX,-02</FONT> line is selected, then press < f5 > to continue:



<FONT  COLOR=#0000FF>0137:004415E8  80240800            AND     BYTE PTR [ECX+EAX],00</FONT> ;?

<FONT  COLOR=#0000FF>0137:004415EC  C20400              RET     0004</FONT> ;return from the call



Well this isn't very interesting either (you can always have a snoop round

yourself by press < f10 > to trace down.  Anyway, don't despair, the good bit

is coming right up, let's hit < f5 > again and we end up here: ----------------+

                                                                               |

(Now, if you're pretty sharp, you'll notice something I missed: hint: it's in  |

one of the registers.  You found it?  Yep, it's that EBP register alright!     |

Not convinced?  Type <B>?ebp</B>, and what value is it?  Our bogus code... okey, so   |

keep an eye on ebp.)                                                           |

                                                                               |

<I>/* start of 'dummy' code generating routine */ <-- ignore this for the moment</I>  |

                                                                               | 

<FONT  COLOR=#0000FF>0137:004287D0  8B01                MOV     EAX,[ECX]</FONT>   <-----------------------+

^ This line moves the content of ECX ([ECX]) into EAX.  What's [ECX]? Type <B>d</B>

<B>ecx</B>:



<FONT  COLOR=#357735>013F:00FB266C  50 72 6f 70 68 65 63 79-00 00 00 00 00 00 00 00  Prophecy........</FONT>



Our name... hmmm, suspicious.  It's important to understand how [ECX] gets

transferred to EAX: EAX consists of 8 numbers, made up of 4 bytes.  A byte is

just the pairs of numbers you see in the data window, eg 50, 72 and 6f are

examples of bytes.  Now, EAX must read 4 bytes from [ECX].  It reads these in

reverse order starting at 70, then 6f, 72 and finally 50, giving the new value

of EAX=706f7250 (which you can see by looking at the EAX value in the registers

window).  So now EAX is equal to the first four letters of our name.



<FONT  COLOR=#0000FF>0137:004287D2  BAFFFEFE7E          MOV     EDX,7EFEFEFF</FONT> ;edx=7efefeff

<FONT  COLOR=#0000FF>0137:004287D7  03D0                ADD     EDX,EAX</FONT> ;edx=edx+eax

^ EDX is now equal to (7efefeff (a possible magic number?) plus EAX).

<FONT  COLOR=#0000FF>0137:004287D9  83F0FF              XOR     EAX,-01</FONT>

^ letters of our name get XORed with -01, result is stored in EAX.

<FONT  COLOR=#0000FF>0137:004287DC  33C2                XOR     EAX,EDX</FONT>

^ letters of our name get XORed with (possible magic number+EAX).

<FONT  COLOR=#0000FF>0137:004287DE  83C104              ADD     ECX,04</FONT>

^ ECX = ECX+4 , meaning that we have already read 4 bytes of our name, and next

time it will start reading at the 5th byte (letter) of our name.

<FONT  COLOR=#0000FF>0137:004287E1  A900010181          TEST    EAX,81010100</FONT>

^ finished encrypting our name?

<FONT  COLOR=#0000FF>0137:004287E6  74E8                JZ      004287D0</FONT> ;yes/no

<FONT  COLOR=#0000FF>0137:004287E8  8B41FC              MOV     EAX,[ECX-04]</FONT>

^ Hrmm EAX has now been overwritten by the content of ECX-4... what was the

point of XORing EAX in the first place?

<FONT  COLOR=#0000FF>0137:004287EB  84C0                TEST    AL,AL</FONT>        ;not quite sure what

<FONT  COLOR=#0000FF>0137:004287ED  7432                JZ      00428821</FONT>     ;all this stuff does

<FONT  COLOR=#0000FF>0137:004287EF  84E4                TEST    AH,AH</FONT>        ;but it basically checks

<FONT  COLOR=#0000FF>0137:004287F1  7424                JZ      00428817</FONT>     ;to see how far thru the

<FONT  COLOR=#0000FF>0137:004287F3  A90000FF00          TEST    EAX,00FF0000</FONT> ;encrypting of our name

<FONT  COLOR=#0000FF>0137:004287F8  7413                JZ      0042880D</FONT>     ;the target is.

<FONT  COLOR=#0000FF>0137:004287FA  A9000000FF          TEST    EAX,FF000000</FONT>

<FONT  COLOR=#0000FF>0137:004287FF  7402                JZ      00428803</FONT>

<FONT  COLOR=#0000FF>0137:00428801  EBCD                JMP     004287D0</FONT>

<FONT  COLOR=#0000FF>0137:00428803  8D41FF              LEA     EAX,[ECX-01] ;let eax=[ecx-1]</FONT>

<FONT  COLOR=#0000FF>0137:00428806  8B4C2404            MOV     ECX,[ESP+04]</FONT>

^ Type <B>D esp+4</B> and you'll see something like:



<FONT  COLOR=#357735>013F:006FF488  6C 2C FB 00 bla bla bla...</FONT> now doesn't that fb2c6c look familiar?

Yep, it's the location of our name (remember, stuff is read in into registers in

blocks of 4 bytes, starting from right to left).



<FONT  COLOR=#0000FF>0137:0042880A  2BC1                SUB     EAX,ECX</FONT>

^ This calculates the length of our name and stores the result in EAX

<FONT  COLOR=#0000FF>0137:0042880C  C3                  RET</FONT>

etc, etc...



<I>/* end of 'dummy' code generating routine */ <-- ignore this for the moment</I>



Well, anyway, I'm getting pretty suspicious by now because all sorts of stuff

is happening to our name.  At this point, I traced carefully through the code

for ages, noting down what was going on.  This is pretty slow and hard work,

but it's good practice for a beginner like me and it also ensures I don't miss

any important points.  Okey, you do the same: hit < f10 > and slowly trace the

code, you eventually hit a RET command and end up here:



<FONT  COLOR=#0000FF>0137:00422FCE  59                  POP     ECX</FONT> ;pop ecx from the stack

<FONT  COLOR=#0000FF>0137:00422FCF  EB02                JMP     00422FD3</FONT>

<FONT  COLOR=#0000FF>0137:00422FD1  33C0                XOR     EAX,EAX</FONT>

<FONT  COLOR=#0000FF>0137:00422FD3  83F805              CMP     EAX,05</FONT>

^ Compares length of our code (EAX) with 5

<FONT  COLOR=#0000FF>0137:00422FD6  7304                JAE     00422FDC</FONT>

^ Jump if EAX is greater than or equal to 5... remember our snooping?  We

already knew our name had to be 5 or greater...

<FONT  COLOR=#0000FF>0137:00422FD8  33C0                XOR     EAX,EAX</FONT> ;set eax=0

<FONT  COLOR=#0000FF>0137:00422FDA  EB2B                JMP     00423007</FONT>

<FONT  COLOR=#0000FF>0137:00422FDC  BEA4E4FE5D          MOV     ESI,5DFEE4A4</FONT>

^ move 5dfee4a4 (another possible magic number?) into ESI

<FONT  COLOR=#0000FF>0137:00422FE1  33DB                XOR     EBX,EBX</FONT> ;set ebx=0

<FONT  COLOR=#0000FF>0137:00422FE3  85FF                TEST    EDI,EDI</FONT> ;?did we enter a name?

^ Have you checked what EDI is? (Type<B> D edi</B>)... it's our name!

<FONT  COLOR=#0000FF>0137:00422FE5  7409                JZ      00422FF0</FONT> ;yes/no

<FONT  COLOR=#0000FF>0137:00422FE7  57                  PUSH    EDI</FONT>

^ This pushes our name to a function.  It is important to know how functions

work:  (some) functions require parameters.  For example, consider this function

here: sum(a,b).  This function gets two numbers, a and b and adds them.  a and b

are the parameters of the function, sum.  Now in assembler this would look like:



PUSH a ;eg PUSH 30

PUSH b ;eg PUSH 12

CALL sum ;this would actually be some memory location which points to the

         ;function sum



Anyway, now that you've got the general idea you can see the importance of the

above PUSH EDI:



<FONT  COLOR=#0000FF>0137:00422FE8  E8C3570000          CALL    004287B0</FONT>

^ This calls a function, which has our name as it's only parameter!



Okey, so this function could be important, so we want to step into it and

investigate: select the <FONT  COLOR=#0000FF>CALL 004287B0</FONT> line and hit < f8 >.  Now let's see where

we end up:



<FONT  COLOR=#0000FF>0137:004287B0  8B4C2404            MOV     ECX,[ESP+04]</FONT>

^ set up ECX so that it points to our name

<FONT  COLOR=#0000FF>0137:004287B4  F7C103000000        TEST    ECX,00000003</FONT> ;?

<FONT  COLOR=#0000FF>0137:004287BA  7414                JZ      004287D0</FONT>

<FONT  COLOR=#0000FF>0137:004287BC  8A01                MOV     AL,[ECX]</FONT>

^ move first byte of our name into AL

<FONT  COLOR=#0000FF>0137:004287BE  41                  INC     ECX</FONT> ;ecx=ecx+1

<FONT  COLOR=#0000FF>0137:004287BF  84C0                TEST    AL,AL</FONT> ;?did we enter a name

<FONT  COLOR=#0000FF>0137:004287C1  7440                JZ      00428803</FONT> ;yes/no

<FONT  COLOR=#0000FF>0137:004287C3  F7C103000000        TEST    ECX,00000003</FONT> ;?finished encrypting

<FONT  COLOR=#0000FF>0137:004287C9  75F1                JNZ     004287BC</FONT>     ;our name yet? yes/no.

<FONT  COLOR=#0000FF>0137:004287CB  0500000000          ADD     EAX,00000000</FONT> ;seems pretty pointless.

<FONT  COLOR=#0000FF>0137:004287D0  8B01                MOV     EAX,[ECX]</FONT>

^ Move the first 4 letters of our name into EAX



Well now, what have we here?  Looks like we're back to the start of the 'dummy'

code generating routine... I call this the 'dummy' code generating routine

because it doesn't seem to have a purpose.  I think that the programmer may have

put it in to send a naive cracker down the wrong track (fat chance hehe)...

anyway, maybe I missed the subtle point... let's continue:



<FONT  COLOR=#0000FF>0137:004287D2  BAFFFEFE7E          MOV     EDX,7EFEFEFF

0137:004287D7  03D0                ADD     EDX,EAX

0137:004287D9  83F0FF              XOR     EAX,-01

.

.

0137:0042880C  C3                  RET</FONT> ;let's leave the 'dummy' routine



Okay, perserverence is the key to success, so let's forge on, hit < f10 > until

you reach <FONT  COLOR=#0000FF>RET</FONT>, and you end up here:



<FONT  COLOR=#0000FF>0137:00422FED  59                  POP     ECX</FONT> ;pop ecx from the stack

<FONT  COLOR=#0000FF>0137:00422FEE  EB02                JMP     00422FF2

0137:00422FF0  33C0                XOR     EAX,EAX</FONT> ;set eax=0

<FONT  COLOR=#0000FF>0137:00422FF2  83C0FC              ADD     EAX,-04</FONT>

^ ?this is probably used to keep a check on how far through the 'dummy' (or even

the real code) generating routine the target is...

<FONT  COLOR=#0000FF>0137:00422FF5  3BD8                CMP     EBX,EAX</FONT>

^ EBX was a counter used in the 'dummy' routine.  ?Compares to see if we are

finished the routine yet...

<FONT  COLOR=#0000FF>0137:00422FF7  730C                JAE     00423005</FONT> ;yes/no

<FONT  COLOR=#0000FF>0137:00422FF9  33343B              XOR     ESI,[EDI+EBX]</FONT>

^ Okey, now this looks interesting!  ESI (a possible magic number remember?) is

XORed with the contents of EDI+EBX and the result is stored in ESI... now what

is [EDI+EBX]?  type <B>d edi+ebx</B>... well, well, well, if it isn't our name. We'll

have to keep a close eye on our friend ESI... now keep tracing and you'll end up

here:



<FONT  COLOR=#0000FF>0137:00422FE3  85FF                TEST    EDI,EDI</FONT> ;?did we enter a code?

<FONT  COLOR=#0000FF>0137:00422FE5  7409                JZ      00422FF0</FONT> ;?yes/no

<FONT  COLOR=#0000FF>0137:00422FE7  57                  PUSH    EDI</FONT> ;push our name to the stack

<FONT  COLOR=#0000FF>0137:00422FE8  E8C3570000          CALL    004287B0</FONT>

^ Well, no prizes for guess what routine this <FONT  COLOR=#0000FF>CALL</FONT> is to... yep, our 'dummy'

code generating routine.  Well at this stage you can just step over this

routine rather than into it, but you'll need to disable your breakpoint on

your name which can be done by typing <B>bd 1</B> (otherwise you'll just pop into

the routine anyway, because our name is being accessed by it).  Okey, now that

you've stepped over the routine (or you can step into it if you want, it'll just

take longer- and that's the way I did it, because I guess I wasn't thinking hard

enough, and I was just methodically stepping into all the interesting calls) you

should reenable the breakpoint on your name by typing <B>be 1</B>.



<FONT  COLOR=#0000FF>0137:00422FED  59                  POP     ECX

0137:00422FEE  EB02                JMP     00422FF2

0137:00422FF0  33C0                XOR     EAX,EAX</FONT> ;set eax=0

<FONT  COLOR=#0000FF>0137:00422FF2  83C0FC              ADD     EAX,-04</FONT> ;eax=eax-4

<FONT  COLOR=#0000FF>0137:00422FF5  3BD8                CMP     EBX,EAX</FONT> ;finished dummy routine?

<FONT  COLOR=#0000FF>0137:00422FF7  730C                JAE     00423005</FONT> ;yes/no

<FONT  COLOR=#0000FF>0137:00422FF9  33343B              XOR     ESI,[EDI+EBX]</FONT>

^ Ok, now we end up here, which is again interesting.  Typing <B>d edi+ebx</B> reveals

that our name has now been shifted accross one and so the contents of EDI+EBX are

the letters 2-5 inclusive or our name, namely 'roph'.  So ESI is XORed with the

letters 2-5, and the result is stored in ESI... do we sense a pattern here? I

think so!  The pattern seems to be that our ESI starts out as the magic number

5dfee4a4, it then gets XORed with the first 4 letters of name, and the result is

stored in the new ESI.  Then the new ESI is XORed with the letters 2-5 of our

name, (and then 3-6, 4-7, 5-8...?).  Anyway, for each <FONT  COLOR=#0000FF>XOR ESI, [EDI+EBX]</FONT>, the

'dummy' routine is called.  Okey, let's confirm our theory, by continuing to

trace downwards... (remember if you see a <FONT  COLOR=#0000FF>PUSH EDI</FONT>, <FONT  COLOR=#0000FF>CALL 004287B0</FONT>, you don't

need to bother stepping into it, just don't forget to disable the breakpoint of

your name and reenable it after you've stepped over the call)... okey, we reach

this interesting point in the code:



<FONT  COLOR=#0000FF>0137:00422FF9  33343B              XOR     ESI,[EDI+EBX]</FONT>

^ XOR ESI with letters 3-6 of our name, which confirms our theory doesn't it?

<FONT  COLOR=#0000FF>0137:00422FFC  F6C340              TEST    BL,40</FONT> ;?

<FONT  COLOR=#0000FF>0137:00422FFF  7401                JZ      00423002

0137:00423001  43                  INC     EBX

0137:00423002  43                  INC     EBX</FONT>

^ this adds 1 to EBX so that at the next <FONT  COLOR=#0000FF>XOR ESI,[EDI+EBX]</FONT> our name has been

shifted accross 1.



Ok, so by now things are becoming pretty obvious... keep tracing but be careful,

as we are nearing the end of our name, you don't want to miss any important

bits!  Ok, now we hit yet another <FONT  COLOR=#0000FF>XOR ESI,[EDI+EBX]</FONT>, this time the contents of

EDI+EBX are letters 4-7 of our name.  Well, let's keep tracing... hey, we've

reached new section of code:



<FONT  COLOR=#0000FF>0137:00423005  8BC6                MOV     EAX,ESI</FONT>

^ ESI, which by now, seems like it has a high chance of being the 'valid' code

is moved into EAX

<FONT  COLOR=#0000FF>0137:00423007  5F                  POP     EDI</FONT> ;pop edi off the stack

<FONT  COLOR=#0000FF>0137:00423008  5E                  POP     ESI</FONT> ;pop esi off the stack

<FONT  COLOR=#0000FF>0137:00423009  5B                  POP     EBX</FONT> ;pop ebx off the stack

<FONT  COLOR=#0000FF>0137:0042300A  C3                  RET</FONT> ;let's get outta here!!



Well, we leave that routine and pop up here:



<FONT  COLOR=#0000FF>0137:00422713  3BE8                CMP     EBP,EAX</FONT>

^ Well, well, well what have here?  Do you remember what EBP was?  If you can't,

check it out now... type <B>?ebp</B>, yup, it's our bogus code, and we're pretty sure

it's being compared to the 'valid' code!  (Well, this programmer's efforts have

been substantially minimized by leaving an unencrypted 'bogus' code lying

around, and then comparing it with what we believe is the valid one... the

programmer should have been smarter and first of all encrypted our bogus code,

then encrypted the valid code and then compared the two encrypted codes... but

no, he was too lazy, and it cost him! < evil laughter >).



<I>(Note that at this point, you can simply type <B>?eax</B> and this would display

what we believe is our valid code (for me, I got 1139597721), and a cracker who

was just after a serial number could have quickly obtained it from here,

however, we were interested in disecting the code generating routine to bits, and

eventually writing a key generator (which is a much better and more worthwhile

exercise than quickly rushing in and finding the serial number!)</I>



<FONT  COLOR=#0000FF>0137:00422715  59                  POP     ECX

0137:00422716  750F                JNZ     00422727</FONT>

^ if the codes don't match, then go to 'naughty cracker', otherwise continue.



Anyway, I bet your dying to see if EAX is really the valid code, so hit < F10 >

until you reach the <FONT  COLOR=#0000FF>JNZ 00422727</FONT>.  Okay, we want to skip the jump, so that we

can check if that EAX is the real code.  How do we do this?  Okay, if you notice

in the upper right part of the register window, we have a small 'z', this means

that the zero flag isn't set, (ie the two codes didn't match)... we want to

force the flag so that we fool the target into thinking the codes matched...

we do this by typing <B>r fl z</B>.  Okey, now comes the test, let's clear all

the breakpoints we've set by typing <B>bc *</B> and leave SoftIce by hitting

< f5 >... and we're back in Teleport Pro and *boom* "Thankyou, your copy of

Teleport Pro is now registered blablabla". Yeehaa!



Okey, so let's recap on how the code is generated using our name:



We start off with a magic number (5DFEE4A4) and this gets XORed with the first 4

letters of our name and the result is stored in ESI.  Then ESI is XORed with the

letters 2-5 of our name and a new value is stored in ESI.  This process keeps

going until letters (n-4)-(n-1) have been read, where n represents the length of

your name.  (Try entereing a name of different length to the one you used

through out the essay, and you'll see this is indeed the case).  So now we know

exactly how the valid code is calculated based upon our name.  I have written a

key generator in C for the target, and you are free to use and modify my source

code for your own key generators!



(<I>I apologize in advance to the C gurus out there, because my code is probably

not written in the best of ways (hey, I'm only a beginner at C too), however,

I find that when you try and write efficient C, it becomes rather cryptic and

hard to follow, and because this essay is aimed at beginners, I wanted it as

easy as possible to follow...</I>



So, without further ado, here is my C source code, fully commented so that it

may be easily understood:



<B>--------------------------------<A NAME="startofkeygen">start tprokgen.c</A>--------------------------------</B>

<FONT  COLOR=#808070>/* Your first keygen... yeehaa!

 *

 * This code can be used by anyone except Bill GAYtes (haha)... */ 



/* Note: because this proggie uses 32bit unsigned long integers, you might not

 * have any luck get a DOS executable going because DOS is only 16 bit (there

 * probably is a way, but I didn't find it), so you'll have to compile it to

 * run under win32... good luck! */</FONT>



<FONT  COLOR=#4BB463>#include</FONT> <FONT  COLOR=#0000FF>&ltstdio.h&gt</FONT> <FONT  COLOR=#808070>/* import the standard i/o library */</FONT>



<B>int</B> main()

<B>{</B> <FONT  COLOR=#808070>/* start of key generator */



/* Set up the variables...



 * your_name is the string where your name is stored (up to 508 characters

   (remember, C terminates all strings by a null character).  (509 is the

   minimum length string that C compilers must support.. hehe, damn I'm a geek)

 * *p is a pointer to your_name

 * length_of name is self explanatory, as is your_code

 * buffer is where the characters making up the user's name are read into (much

   like EAX, ECX etc...

 * i,j,k are counter variables used in the loops */</FONT>



<B>unsigned char</B> your_name[509], *p;

<B>unsigned long int</B> buffer, your_code;

<B>int</B> i,j,k,length_of_name;



<FONT  COLOR=#808070>/* Initialize the variables...



 * your_code starts off as the "magic number" but quickly changes as it gets

   XORed with the characters of the your name

 * set initial length of name = 0

 * set p to point to your_name

 * the sum starts off = 0

 * set up counter variables so that the code is calculated correctly (these

   values become more apparent as you move further on) */</FONT>



your_code=<FONT  COLOR=#0000FF>0x5dfee4a4</FONT>;

length_of_name=<FONT  COLOR=#0000FF>0</FONT>;

p=your_name;

buffer=<FONT  COLOR=#0000FF>0</FONT>;

i=<FONT  COLOR=#0000FF>3</FONT>;

j=<FONT  COLOR=#0000FF>4</FONT>;

k=<FONT  COLOR=#0000FF>0</FONT>;



<FONT  COLOR=#808070>/* Introductory blurb etc */</FONT>

printf("<FONT  COLOR=#0000FF>UŸŸŸŸŸŸŸ ƒ ŸŸŸ Ð ŸŸŸŸŸŸŸ ƒ ŸŸŸŸŸŸŸŸŸŸŸŸø\n</FONT>");

printf("<FONT  COLOR=#0000FF>_þUU¾þUUU¾þUU¾þUU¾Ð   Ð¾U¾ þ¾UU¾þUUU¾þ 3\n</FONT>");

printf("<FONT  COLOR=#0000FF>3  þƒ UUU¾ Uƒ  UUUþ¾Ð UUU¾  UUU¾ UUU¾  3\n</FONT>");

printf("<FONT  COLOR=#0000FF>3    ƒUUU¾    ƒUUU  UUUUU¾ ƒUUU¾ UUU¾  3\n</FONT>");

printf("<FONT  COLOR=#0000FF>3   Ð¾UUU¾Ð  Ð¾UUU¾Ð þ¾UU¾Ð¾UUU¾Ð¾UU¾Ð 3\n</FONT>");

printf("<FONT  COLOR=#0000FF>AŸŸŸŸŸŸŸŸŸŸŸŸŸŸŸŸŸŸŸŸŸ þþ¾ ŸŸŸŸŸŸŸŸŸŸŸŸU\n</FONT>");

printf("<FONT  COLOR=#0000FF>\nKey Generator for Teleport Pro v1.29 (Build 662)</FONT>");

printf("<FONT  COLOR=#0000FF>\nWritten by Prophecy [TNO]\n\n</FONT>");



<FONT  COLOR=#808070>/* Get the name */</FONT>

tryagain:

printf("<FONT  COLOR=#0000FF>Please enter your name: </FONT>");



<FONT  COLOR=#808070>/* Store your name in your_name */</FONT>

gets(your_name);



<FONT  COLOR=#808070>/* Calculate the length of your name... \0 represents the NULL character which

   is at the end of any C string, and hence used to find length of strings...*/</FONT>



<B>while</B> (*p != <FONT  COLOR=#0000FF>'\0'</FONT>)

   <B>{</B>

   p++;

   length_of_name++;

   <B>}</B>



p=your_name; <FONT  COLOR=#808070>/* Set p so that it points back to the start of your_name */</FONT>



<FONT  COLOR=#808070>/* Our name must be at least 5 characters long remember? If your name isn't at

   least 5 characters long, then you get to enter your name again */</FONT>



<B>if</B> (length_of_name <FONT  COLOR=#0000FF>5</FONT>)

   <B>{</B>

   printf("<FONT  COLOR=#0000FF>Your name must be at least 5 characters long! Try again... \n\n</FONT>");

   goto tryagain; <FONT  COLOR=#808070>/* Enter your name in again */</FONT>

   <B>}</B>





<FONT  COLOR=#808070>/* Ok, here starts the code generation routine... there are two while loops, an

   outer one, and an inner one.  The outer one checks to see if we're one away

   from the end of the string, while the inner one reads in the characters of

   the name so that the code can be generated. */</FONT>



<B>while</B> (j <= length_of_name-<FONT  COLOR=#0000FF>1</FONT>) <FONT  COLOR=#808070>/* start of outer loop */</FONT>

   <B>{</B>

   <B>while</B>(i >= k) <FONT  COLOR=#808070>/* start of inner loop */</FONT>

      <B>{</B>



<FONT  COLOR=#808070>      /* The buffer works like this: it starts off as 0, then you add to it the

      first char of your name (p[0]).  Then you multiply it by 0x100 which

      creates space for the next char to be added into to the buffer. This

      repeats 4 times until the first 4 chars (chars 1-4) have been read in

      reverse order (this is how numbers are stored in registers (EAX etc)

      remember?).  The buffer is then XORed as described in the essay. Then k

      increases by 1, and i is increased by j+4, and the chars 2-5 are read and

      XORed.  This keeps going until chars (n-4)-(n-1) have been read, where n

      represents the length of your_name. */</FONT>



      buffer=(buffer*<FONT  COLOR=#0000FF>0x100LU</FONT>) + p[i]; <FONT  COLOR=#808070>/* read in the characters of your name */</FONT>

      i--; <FONT  COLOR=#808070>/* decrease i by 1 */</FONT>

      <B>}</B> <FONT  COLOR=#808070>/* end of inner loop */</FONT>



   your_code=(your_code^buffer); <FONT  COLOR=#808070>/* XOR your_code with the buffer */</FONT>

   j++; <FONT  COLOR=#808070>/* increment j */</FONT>

   k++; <FONT  COLOR=#808070>/* increment k */</FONT>

   i=j+<FONT  COLOR=#0000FF>4</FONT>; <FONT  COLOR=#808070>/* increase i */</FONT>

   buffer=<FONT  COLOR=#0000FF>0</FONT>; <FONT  COLOR=#808070>/* reset the buffer to 0 */</FONT>

   <B>}</B> <FONT  COLOR=#808070>/* end of outer loop */</FONT>



<FONT  COLOR=#808070>/* Print the code to the screen */</FONT>

printf(<FONT  COLOR=#0000FF>"Your code is: %u "</FONT>,your_code);



return <FONT  COLOR=#0000FF>0</FONT>; <FONT  COLOR=#808070>/* Tells environment that the programme finished normally */</FONT>

<B>}</B> <FONT  COLOR=#808070>/* end of key generator */</FONT>



<B>---------------------------------end tprokgen.c---------------------------------</B>



<B><FONT  SIZE=+1><A NAME="credits">Credits:</A></FONT></B>



Well folks, that's about it, but of course, an essay can't be complete with all

the necessary credits...:



These people (or the stuff they've written) have helped me out a lot (in no

particular order):



natzgul, Y, cruehead, gij, corn2, niabi, aescalapius, tkc, mammon_, the

contributers to fravia's academy, the #cracking4newbies crew and probably a

whole bunch of others I missed...



These sites were also of great help:



<A HREF="index.htm" tppabs="http://www.anticrack.de/fravia/index.htm">http://fravia.org</A> <THIS site kicks arse (fravia's fortress)

<A HREF="javascript:if(confirm('http://failure.ml.org/~mib/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://failure.ml.org/~mib/'" tppabs="http://failure.ml.org/~mib/">http://failure.ml.org/~mib/</A> <THE messing in bytes homepage

<A HREF="javascript:if(confirm('http://home.cracking.ml.org/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://home.cracking.ml.org/'" tppabs="http://home.cracking.ml.org/">http://home.cracking.ml.org</A> <LORD caligo's page... get all your cracking

                                tools here



</prE>

<BR><BR>



<!-- FINAL NOTES STARTS HERE -->

<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >

<TR><TD bgcolor="#C6E7C6"><CENTER><FONT size=+2><FONT color=blue><A NAME="finalwords">Final</A> Notes</FONT>

</FONT></CENTER></TD></TR></TABLE>

<PRE>



I hope that this essay has helped you and has been easy to follow... I certainly

went to great lengths to ensure it was as simple and as error-free as possible.

You should now be less afraid of SoftIce and overbloated protection schemes like

this one... if this essay has helped, then I am satisfied.  Good luck with your

future cracks, and may the mighty zen force of the older ones be with you!



You can mail me <A HREF="mailto:prophecy_@usa.net">here</A> to tell me what you thought of my essay and to suggest

improvements!



<B>Veni vidi vici.</B>



<!-- PASTE HERE YOUR FINAL NOTES (if any) -->

</PRE>

<BR><BR>



<!-- OB DUH STARTS HERE -->

<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >

<TR><TD bgcolor="#C6E7C6"><CENTER><FONT size=+2><FONT color=blue>Ob Duh</FONT></FONT>

</CENTER></TD></TR></TABLE>

 <CENTER>

   <I>I wont even bother explaining you 

   that you should BUY this target program if you intend to use it for a longer 

   period than the allowed one. Should you want 

   to STEAL this software instead, you don't need to crack its protection 

   scheme at all: you'll 

   find it on most Warez sites, complete and already regged, farewell.</I>

</CENTER>



<!-- WAY OUT STARTS HERE -->

<HR>

<CENTER><I>You are deep inside fravia's page of reverse engineering,  

choose your way out:</I></CENTER>

<BR><CENTER>

<!-- EITHER A NICE GIF LIKE THIS -->



<!-- 

<a href="project3.htm" tppabs="http://www.anticrack.de/fravia/project3.htm"><IMG SRC="project3.gif" tppabs="http://www.anticrack.de/fravia/project3.gif" 

ALT="projecT3" ALIGN=CENTER WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a>

<br>

<font color=gray>Back to project 3</FonT>

<br><bR>

-->



<!-- OR JUST A LINK LIKE THIS -->



<!--

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="project1.htm" tppabs="http://www.anticrack.de/fravia/project1.htm">Back to Your_chosen_project</A> 

<hr width=33%>

-->



<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="index.html" tppabs="http://www.anticrack.de/fravia/index.html">homepage</A>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="links.htm" tppabs="http://www.anticrack.de/fravia/links.htm">links</A> 

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="searengi.htm" tppabs="http://www.anticrack.de/fravia/searengi.htm">search_forms</A>



<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="orc.htm" tppabs="http://www.anticrack.de/fravia/orc.htm">+ORC</A>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="student.htm" tppabs="http://www.anticrack.de/fravia/student.htm">students' essays</A>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="academy.htm" tppabs="http://www.anticrack.de/fravia/academy.htm">academy database</A>

<BR>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="realicra.htm" tppabs="http://www.anticrack.de/fravia/realicra.htm">reality cracking</A>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="howtosea.htm" tppabs="http://www.anticrack.de/fravia/howtosea.htm">how to search</A>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="javascri.htm" tppabs="http://www.anticrack.de/fravia/javascri.htm">javascript wars</A>

<BR>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="tools.htm" tppabs="http://www.anticrack.de/fravia/tools.htm">tools</A>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="noanon.htm" tppabs="http://www.anticrack.de/fravia/noanon.htm">anonymity academy</A> 

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="cocktail.htm" tppabs="http://www.anticrack.de/fravia/cocktail.htm">cocktails</A>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="ideale.htm" tppabs="http://www.anticrack.de/fravia/ideale.htm">antismut CGI-scripts</A>



<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="info.htm" tppabs="http://www.anticrack.de/fravia/info.htm">mail_fravia+</A>

<BR>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="legal.htm" tppabs="http://www.anticrack.de/fravia/legal.htm">Is reverse engineering legal?</A>

</CENTER>

<HR>

<!-- THAT'S ALL, THANKS A LOT this will allow automated retrieval -->

</BODY>

</HTML>

